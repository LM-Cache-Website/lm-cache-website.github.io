Search.setIndex({"alltitles": {"3 Min Quick Example: Docker + Speedup with vLLM": [[41, null]], "Advanced": [[42, null]], "Building Docker from Source": [[39, "building-docker-from-source"]], "CPU Offloading": [[35, null]], "Clean up": [[41, "clean-up"]], "Configure LMCache": [[42, null]], "Configuring LMCache v0": [[22, null]], "Configuring LMCache v1": [[24, null]], "Detailed Examples": [[42, null]], "Developer Documentation": [[42, null]], "Disaggregated prefill": [[36, null]], "Docker Installation": [[39, null]], "Documentation": [[42, "documentation"]], "End-to-end measurements": [[33, null]], "Getting Started": [[42, null]], "How to:": [[31, "how-to"], [32, "how-to"], [34, "how-to"]], "Install from source (v0)": [[40, "install-from-source-v0"]], "Install from source (v1)": [[40, "install-from-source-v1"]], "Install pip released versions (v0)": [[40, "install-pip-released-versions-v0"]], "Instance-Level Overview": [[28, "instance-level-overview"]], "Inter-Instance Overview": [[28, "inter-instance-overview"]], "Introduction": [[41, "introduction"]], "KV blending": [[31, null]], "LLM Engine": [[25, null]], "LMCache Backend": [[26, null]], "LMCache Blend": [[1, null]], "LMCache Engine": [[27, null]], "LMCache Experimental": [[2, null]], "LMCache Integration": [[11, null]], "LMCache Modules": [[0, null]], "LMCache Overview": [[28, null]], "LMCache Server": [[13, null]], "LMCache Storage Backend": [[15, null]], "LMCache v0": [[21, null], [30, null]], "LMCache v1": [[23, null], [37, null]], "Models": [[42, null]], "Module contents": [[1, "module-lmcache.blend"], [2, "module-lmcache.experimental"], [3, "module-lmcache.experimental.distributed_server"], [4, "module-lmcache.experimental.lookup_server"], [5, "module-lmcache.experimental.server"], [6, "module-lmcache.experimental.server.storage_backend"], [7, "module-lmcache.experimental.storage_backend"], [8, "module-lmcache.experimental.storage_backend.connector"], [9, "module-lmcache.experimental.storage_backend.evictor"], [10, "module-lmcache.experimental.storage_backend.naive_serde"], [11, "module-lmcache.integration"], [12, "module-lmcache.integration.vllm"], [17, "module-lmcache.storage_backend.evictor"], [18, "module-lmcache.storage_backend.mem_pool"]], "P2P KV Cache Sharing": [[38, null]], "Performance metrics": [[33, "performance-metrics"]], "Pip Installation": [[40, null]], "Prerequisites": [[38, "prerequisites"], [41, "prerequisites"]], "Pulling the Docker Image:": [[39, "pulling-the-docker-image"]], "Quickstart (v0)": [[40, "quickstart-v0"]], "Quickstart (v1)": [[40, "quickstart-v1"]], "Requirements": [[40, "requirements"]], "Run the demo": [[41, "run-the-demo"]], "Running further tests": [[33, "running-further-tests"]], "Running the Docker Container": [[39, "running-the-docker-container"]], "Running the tests": [[33, "running-the-tests"]], "Saving the decode cache": [[34, null]], "Selecting a backend": [[29, null]], "Steps": [[38, "steps"]], "Submodules": [[0, "submodules"], [1, "submodules"], [2, "submodules"], [3, "submodules"], [4, "submodules"], [5, "submodules"], [6, "submodules"], [7, "submodules"], [8, "submodules"], [9, "submodules"], [10, "submodules"], [12, "submodules"], [14, "submodules"], [15, "submodules"], [16, "submodules"], [17, "submodules"], [18, "submodules"], [19, "submodules"]], "Subpackages": [[0, "subpackages"], [2, "subpackages"], [5, "subpackages"], [7, "subpackages"], [11, "subpackages"], [13, "subpackages"], [15, "subpackages"]], "Supported Models": [[43, null]], "Testing the Docker Container": [[39, "testing-the-docker-container"]], "Usage": [[32, null]], "Using a YAML configuration file": [[22, "using-a-yaml-configuration-file"], [24, "using-a-yaml-configuration-file"]], "Using environment variables": [[22, "using-environment-variables"], [24, "using-environment-variables"]], "Version Compatibility Matrix": [[40, "version-compatibility-matrix"]], "Welcome to LMCache!": [[42, null]], "What happens when you run the demo?": [[41, "what-happens-when-you-run-the-demo"]], "What steps do you need to perform?": [[41, "what-steps-do-you-need-to-perform"]], "What\u2019s next?": [[42, "what-s-next"]], "lmcache": [[20, null]], "lmcache.blend.executor module": [[1, "module-lmcache.blend.executor"]], "lmcache.blend.interfaces module": [[1, "module-lmcache.blend.interfaces"]], "lmcache.blend.retriever module": [[1, "module-lmcache.blend.retriever"]], "lmcache.experimental.cache_engine module": [[2, "module-lmcache.experimental.cache_engine"]], "lmcache.experimental.config module": [[2, "module-lmcache.experimental.config"]], "lmcache.experimental.distributed_server package": [[3, null]], "lmcache.experimental.distributed_server.abstract_server module": [[3, "module-lmcache.experimental.distributed_server.abstract_server"]], "lmcache.experimental.distributed_server.naive_server module": [[3, "module-lmcache.experimental.distributed_server.naive_server"]], "lmcache.experimental.gpu_connector module": [[2, "module-lmcache.experimental.gpu_connector"]], "lmcache.experimental.lookup_server package": [[4, null]], "lmcache.experimental.lookup_server.abstract_server module": [[4, "module-lmcache.experimental.lookup_server.abstract_server"]], "lmcache.experimental.lookup_server.redis_server module": [[4, "module-lmcache.experimental.lookup_server.redis_server"]], "lmcache.experimental.memory_management module": [[2, "module-lmcache.experimental.memory_management"]], "lmcache.experimental.server package": [[5, null]], "lmcache.experimental.server.storage_backend package": [[6, null]], "lmcache.experimental.server.storage_backend.abstract_backend module": [[6, "module-lmcache.experimental.server.storage_backend.abstract_backend"]], "lmcache.experimental.server.storage_backend.local_backend module": [[6, "module-lmcache.experimental.server.storage_backend.local_backend"]], "lmcache.experimental.server.utils module": [[5, "module-lmcache.experimental.server.utils"]], "lmcache.experimental.storage_backend package": [[7, null]], "lmcache.experimental.storage_backend.abstract_backend module": [[7, "module-lmcache.experimental.storage_backend.abstract_backend"]], "lmcache.experimental.storage_backend.connector package": [[8, null]], "lmcache.experimental.storage_backend.connector.base_connector module": [[8, "module-lmcache.experimental.storage_backend.connector.base_connector"]], "lmcache.experimental.storage_backend.connector.infinistore_connector module": [[8, "module-lmcache.experimental.storage_backend.connector.infinistore_connector"]], "lmcache.experimental.storage_backend.connector.lm_connector module": [[8, "module-lmcache.experimental.storage_backend.connector.lm_connector"]], "lmcache.experimental.storage_backend.connector.redis_connector module": [[8, "module-lmcache.experimental.storage_backend.connector.redis_connector"]], "lmcache.experimental.storage_backend.evictor package": [[9, null]], "lmcache.experimental.storage_backend.evictor.base_evictor module": [[9, "module-lmcache.experimental.storage_backend.evictor.base_evictor"]], "lmcache.experimental.storage_backend.evictor.lru_evictor module": [[9, "module-lmcache.experimental.storage_backend.evictor.lru_evictor"]], "lmcache.experimental.storage_backend.local_disk_backend module": [[7, "module-lmcache.experimental.storage_backend.local_disk_backend"]], "lmcache.experimental.storage_backend.naive_serde package": [[10, null]], "lmcache.experimental.storage_backend.naive_serde.cachegen_basics module": [[10, "module-lmcache.experimental.storage_backend.naive_serde.cachegen_basics"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_decoder module": [[10, "module-lmcache.experimental.storage_backend.naive_serde.cachegen_decoder"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_encoder module": [[10, "module-lmcache.experimental.storage_backend.naive_serde.cachegen_encoder"]], "lmcache.experimental.storage_backend.naive_serde.kivi_serde module": [[10, "module-lmcache.experimental.storage_backend.naive_serde.kivi_serde"]], "lmcache.experimental.storage_backend.naive_serde.naive_serde module": [[10, "module-lmcache.experimental.storage_backend.naive_serde.naive_serde"]], "lmcache.experimental.storage_backend.naive_serde.serde module": [[10, "module-lmcache.experimental.storage_backend.naive_serde.serde"]], "lmcache.experimental.storage_backend.storage_manager module": [[7, "module-lmcache.experimental.storage_backend.storage_manager"]], "lmcache.experimental.token_database module": [[2, "module-lmcache.experimental.token_database"]], "lmcache.integration.vllm package": [[12, null]], "lmcache.integration.vllm.utils module": [[12, "module-lmcache.integration.vllm.utils"]], "lmcache.integration.vllm.vllm_adapter module": [[12, "module-lmcache.integration.vllm.vllm_adapter"]], "lmcache.logging module": [[0, "module-lmcache.logging"]], "lmcache.protocol module": [[0, "module-lmcache.protocol"]], "lmcache.server.server_storage_backend package": [[14, null]], "lmcache.server.server_storage_backend.abstract_backend module": [[14, "module-lmcache.server.server_storage_backend.abstract_backend"]], "lmcache.server.server_storage_backend.local_backend module": [[14, "module-lmcache.server.server_storage_backend.local_backend"]], "lmcache.storage_backend.abstract_backend module": [[15, "module-lmcache.storage_backend.abstract_backend"]], "lmcache.storage_backend.connector package": [[16, null]], "lmcache.storage_backend.connector.base_connector module": [[16, "module-lmcache.storage_backend.connector.base_connector"]], "lmcache.storage_backend.connector.lm_connector module": [[16, "module-lmcache.storage_backend.connector.lm_connector"]], "lmcache.storage_backend.connector.redis_connector module": [[16, "module-lmcache.storage_backend.connector.redis_connector"]], "lmcache.storage_backend.evictor package": [[17, null]], "lmcache.storage_backend.evictor.base_evictor module": [[17, "module-lmcache.storage_backend.evictor.base_evictor"]], "lmcache.storage_backend.evictor.lru_evictor module": [[17, "module-lmcache.storage_backend.evictor.lru_evictor"]], "lmcache.storage_backend.hybrid_backend module": [[15, "module-lmcache.storage_backend.hybrid_backend"]], "lmcache.storage_backend.local_backend module": [[15, "module-lmcache.storage_backend.local_backend"]], "lmcache.storage_backend.mem_pool package": [[18, null]], "lmcache.storage_backend.mem_pool.base_pool module": [[18, "module-lmcache.storage_backend.mem_pool.base_pool"]], "lmcache.storage_backend.mem_pool.local_pool module": [[18, "module-lmcache.storage_backend.mem_pool.local_pool"]], "lmcache.storage_backend.remote_backend module": [[15, "module-lmcache.storage_backend.remote_backend"]], "lmcache.storage_backend.serde package": [[19, null]], "lmcache.storage_backend.serde.cachegen_basics module": [[19, "module-lmcache.storage_backend.serde.cachegen_basics"]], "lmcache.storage_backend.serde.cachegen_decoder module": [[19, "module-lmcache.storage_backend.serde.cachegen_decoder"]], "lmcache.storage_backend.serde.cachegen_encoder module": [[19, "module-lmcache.storage_backend.serde.cachegen_encoder"]], "lmcache.storage_backend.serde.fast_serde module": [[19, "module-lmcache.storage_backend.serde.fast_serde"]], "lmcache.storage_backend.serde.safe_serde module": [[19, "module-lmcache.storage_backend.serde.safe_serde"]], "lmcache.storage_backend.serde.serde module": [[19, "module-lmcache.storage_backend.serde.serde"]], "lmcache.storage_backend.serde.torch_serde module": [[19, "module-lmcache.storage_backend.serde.torch_serde"]], "lmcache.utils module": [[0, "module-lmcache.utils"]], "v0 Configure LMCache": [[21, null]], "v0 Examples": [[30, null]], "v1 Configure LMCache": [[23, null]], "v1 Examples": [[37, null]]}, "docnames": ["advanced/lmcache", "advanced/lmcache.blend", "advanced/lmcache.experimental", "advanced/lmcache.experimental.distributed_server", "advanced/lmcache.experimental.lookup_server", "advanced/lmcache.experimental.server", "advanced/lmcache.experimental.server.storage_backend", "advanced/lmcache.experimental.storage_backend", "advanced/lmcache.experimental.storage_backend.connector", "advanced/lmcache.experimental.storage_backend.evictor", "advanced/lmcache.experimental.storage_backend.naive_serde", "advanced/lmcache.integration", "advanced/lmcache.integration.vllm", "advanced/lmcache.server", "advanced/lmcache.server.server_storage_backend", "advanced/lmcache.storage_backend", "advanced/lmcache.storage_backend.connector", "advanced/lmcache.storage_backend.evictor", "advanced/lmcache.storage_backend.mem_pool", "advanced/lmcache.storage_backend.serde", "advanced/modules", "configuration/v0/index", "configuration/v0/v0_config", "configuration/v1/index", "configuration/v1/v1_config", "developer_tutorial/LLM_Engine", "developer_tutorial/LMCache_Backend", "developer_tutorial/LMCache_Engine", "developer_tutorial/overview", "examples/v0/backend", "examples/v0/index", "examples/v0/kv_blending", "examples/v0/launching", "examples/v0/measuring_improvements", "examples/v0/save_decode", "examples/v1/cpu_offload", "examples/v1/disagg", "examples/v1/index", "examples/v1/p2p", "getting_started/docker", "getting_started/installation", "getting_started/speedup", "index", "models/models"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1}, "filenames": ["advanced/lmcache.rst", "advanced/lmcache.blend.rst", "advanced/lmcache.experimental.rst", "advanced/lmcache.experimental.distributed_server.rst", "advanced/lmcache.experimental.lookup_server.rst", "advanced/lmcache.experimental.server.rst", "advanced/lmcache.experimental.server.storage_backend.rst", "advanced/lmcache.experimental.storage_backend.rst", "advanced/lmcache.experimental.storage_backend.connector.rst", "advanced/lmcache.experimental.storage_backend.evictor.rst", "advanced/lmcache.experimental.storage_backend.naive_serde.rst", "advanced/lmcache.integration.rst", "advanced/lmcache.integration.vllm.rst", "advanced/lmcache.server.rst", "advanced/lmcache.server.server_storage_backend.rst", "advanced/lmcache.storage_backend.rst", "advanced/lmcache.storage_backend.connector.rst", "advanced/lmcache.storage_backend.evictor.rst", "advanced/lmcache.storage_backend.mem_pool.rst", "advanced/lmcache.storage_backend.serde.rst", "advanced/modules.rst", "configuration/v0/index.rst", "configuration/v0/v0_config.rst", "configuration/v1/index.rst", "configuration/v1/v1_config.rst", "developer_tutorial/LLM_Engine.rst", "developer_tutorial/LMCache_Backend.rst", "developer_tutorial/LMCache_Engine.rst", "developer_tutorial/overview.rst", "examples/v0/backend.rst", "examples/v0/index.rst", "examples/v0/kv_blending.rst", "examples/v0/launching.rst", "examples/v0/measuring_improvements.rst", "examples/v0/save_decode.rst", "examples/v1/cpu_offload.rst", "examples/v1/disagg.rst", "examples/v1/index.rst", "examples/v1/p2p.rst", "getting_started/docker.rst", "getting_started/installation.rst", "getting_started/speedup.rst", "index.rst", "models/models.rst"], "indexentries": {}, "objects": {"lmcache": [[1, 0, 0, "-", "blend"], [27, 0, 0, "-", "cache_engine"], [2, 0, 0, "-", "experimental"], [11, 0, 0, "-", "integration"], [0, 0, 0, "-", "logging"], [0, 0, 0, "-", "protocol"], [0, 0, 0, "-", "utils"]], "lmcache.blend": [[1, 0, 0, "-", "executor"], [1, 0, 0, "-", "interfaces"], [1, 0, 0, "-", "retriever"]], "lmcache.blend.executor": [[1, 1, 1, "", "CacheBlendImpl"], [1, 3, 1, "", "create_index"], [1, 3, 1, "", "indices_to_mask"], [1, 3, 1, "", "mask_to_indices"]], "lmcache.blend.executor.CacheBlendImpl": [[1, 2, 1, "", "blend"], [1, 2, 1, "", "set_positional_encoder"], [1, 2, 1, "", "set_reverse_positional_encoder"]], "lmcache.blend.interfaces": [[1, 1, 1, "", "BlendExecutor"], [1, 1, 1, "", "BlendOutput"], [1, 1, 1, "", "BlendRetriever"], [1, 1, 1, "", "BlendRetrieverResult"], [1, 1, 1, "", "BlendRetrieverTask"]], "lmcache.blend.interfaces.BlendExecutor": [[1, 2, 1, "", "blend"]], "lmcache.blend.interfaces.BlendOutput": [[1, 4, 1, "", "k"], [1, 4, 1, "", "local_indices"], [1, 4, 1, "", "positions"], [1, 4, 1, "", "q"], [1, 4, 1, "", "query_start_loc"], [1, 4, 1, "", "v"]], "lmcache.blend.interfaces.BlendRetriever": [[1, 2, 1, "", "new_request"]], "lmcache.blend.interfaces.BlendRetrieverResult": [[1, 4, 1, "", "k"], [1, 4, 1, "", "original_positions"], [1, 4, 1, "", "v"], [1, 4, 1, "", "valid_mask"]], "lmcache.blend.interfaces.BlendRetrieverTask": [[1, 2, 1, "", "result"]], "lmcache.blend.retriever": [[1, 1, 1, "", "SPTBlendRetriever"], [1, 1, 1, "", "SPTBlendRetrieverTask"]], "lmcache.blend.retriever.SPTBlendRetriever": [[1, 2, 1, "", "new_request"]], "lmcache.blend.retriever.SPTBlendRetrieverTask": [[1, 2, 1, "", "result"]], "lmcache.cache_engine": [[27, 1, 1, "", "LMCacheEngine"]], "lmcache.cache_engine.LMCacheEngine": [[27, 2, 1, "", "_blob_to_tuple_kv"], [27, 2, 1, "", "_chunk_kv"], [27, 2, 1, "", "_chunk_tokens"], [27, 2, 1, "", "_get_init_hash"], [27, 2, 1, "", "_hash"], [27, 2, 1, "", "_make_chunks"], [27, 2, 1, "", "_make_chunks_skip_existing"], [27, 2, 1, "", "_make_key"], [27, 2, 1, "", "_num_tokens_in_kv"], [27, 2, 1, "", "_prefix_hash"], [27, 2, 1, "", "_slice_kv_at"], [27, 2, 1, "", "_tuple_kv_to_blob"], [27, 2, 1, "", "close"], [27, 2, 1, "", "lookup"], [27, 2, 1, "", "retrieve"], [27, 2, 1, "", "store"]], "lmcache.experimental": [[2, 0, 0, "-", "cache_engine"], [2, 0, 0, "-", "config"], [3, 0, 0, "-", "distributed_server"], [2, 0, 0, "-", "gpu_connector"], [4, 0, 0, "-", "lookup_server"], [2, 0, 0, "-", "memory_management"], [5, 0, 0, "-", "server"], [7, 0, 0, "-", "storage_backend"], [2, 0, 0, "-", "token_database"]], "lmcache.experimental.cache_engine": [[2, 1, 1, "", "CacheEngineEndSignal"], [2, 1, 1, "", "LMCacheEngine"], [2, 1, 1, "", "LMCacheEngineBuilder"]], "lmcache.experimental.cache_engine.LMCacheEngine": [[2, 2, 1, "", "close"], [2, 2, 1, "", "lookup"], [2, 2, 1, "", "prefetch"], [2, 2, 1, "", "retrieve"], [2, 2, 1, "", "store"]], "lmcache.experimental.cache_engine.LMCacheEngineBuilder": [[2, 2, 1, "", "destroy"], [2, 2, 1, "", "get"], [2, 2, 1, "", "get_or_create"]], "lmcache.experimental.config": [[2, 1, 1, "", "LMCacheEngineConfig"]], "lmcache.experimental.config.LMCacheEngineConfig": [[2, 4, 1, "", "blend_min_tokens"], [2, 4, 1, "", "blend_recompute_ratio"], [2, 4, 1, "", "chunk_size"], [2, 4, 1, "", "distributed_url"], [2, 4, 1, "", "enable_blending"], [2, 4, 1, "", "enable_p2p"], [2, 2, 1, "", "from_defaults"], [2, 2, 1, "", "from_env"], [2, 2, 1, "", "from_file"], [2, 2, 1, "", "from_legacy"], [2, 4, 1, "", "local_cpu"], [2, 4, 1, "", "local_disk"], [2, 4, 1, "", "lookup_url"], [2, 4, 1, "", "max_local_cpu_size"], [2, 4, 1, "", "max_local_disk_size"], [2, 4, 1, "", "remote_serde"], [2, 4, 1, "", "remote_url"], [2, 4, 1, "", "save_decode_cache"], [2, 2, 1, "", "to_original_config"]], "lmcache.experimental.distributed_server": [[3, 1, 1, "", "DistributedServerInterface"], [3, 1, 1, "", "NaiveDistributedServer"], [3, 0, 0, "-", "abstract_server"], [3, 0, 0, "-", "naive_server"]], "lmcache.experimental.distributed_server.DistributedServerInterface": [[3, 2, 1, "", "close"], [3, 2, 1, "", "handle_get"], [3, 2, 1, "", "issue_get"], [3, 2, 1, "", "start"]], "lmcache.experimental.distributed_server.NaiveDistributedServer": [[3, 2, 1, "", "close"], [3, 2, 1, "", "handle_client"], [3, 2, 1, "", "handle_get"], [3, 2, 1, "", "issue_get"], [3, 2, 1, "", "receive_all_client"], [3, 2, 1, "", "receive_all_server"], [3, 2, 1, "", "start"]], "lmcache.experimental.distributed_server.abstract_server": [[3, 1, 1, "", "DistributedServerInterface"]], "lmcache.experimental.distributed_server.abstract_server.DistributedServerInterface": [[3, 2, 1, "", "close"], [3, 2, 1, "", "handle_get"], [3, 2, 1, "", "issue_get"], [3, 2, 1, "", "start"]], "lmcache.experimental.distributed_server.naive_server": [[3, 1, 1, "", "NaiveDistributedServer"]], "lmcache.experimental.distributed_server.naive_server.NaiveDistributedServer": [[3, 2, 1, "", "close"], [3, 2, 1, "", "handle_client"], [3, 2, 1, "", "handle_get"], [3, 2, 1, "", "issue_get"], [3, 2, 1, "", "receive_all_client"], [3, 2, 1, "", "receive_all_server"], [3, 2, 1, "", "start"]], "lmcache.experimental.gpu_connector": [[2, 1, 1, "", "GPUConnectorInterface"], [2, 1, 1, "", "VLLMNestedTupleGPUConnector"], [2, 1, 1, "", "VLLMPagedMemGPUConnector"], [2, 1, 1, "", "VLLMPagedMemGPUConnectorV2"]], "lmcache.experimental.gpu_connector.GPUConnectorInterface": [[2, 2, 1, "", "from_gpu"], [2, 2, 1, "", "get_shape"], [2, 2, 1, "", "to_gpu"]], "lmcache.experimental.gpu_connector.VLLMNestedTupleGPUConnector": [[2, 2, 1, "", "from_gpu"], [2, 2, 1, "", "get_shape"], [2, 2, 1, "", "to_gpu"]], "lmcache.experimental.gpu_connector.VLLMPagedMemGPUConnector": [[2, 2, 1, "", "from_gpu"], [2, 2, 1, "", "get_shape"], [2, 2, 1, "", "to_gpu"]], "lmcache.experimental.gpu_connector.VLLMPagedMemGPUConnectorV2": [[2, 2, 1, "", "from_gpu"], [2, 2, 1, "", "get_shape"], [2, 2, 1, "", "to_gpu"]], "lmcache.experimental.lookup_server": [[4, 1, 1, "", "LookupServerInterface"], [4, 1, 1, "", "RedisLookupServer"], [4, 0, 0, "-", "abstract_server"], [4, 0, 0, "-", "redis_server"]], "lmcache.experimental.lookup_server.LookupServerInterface": [[4, 2, 1, "", "batched_remove"], [4, 2, 1, "", "insert"], [4, 2, 1, "", "lookup"], [4, 2, 1, "", "remove"]], "lmcache.experimental.lookup_server.RedisLookupServer": [[4, 2, 1, "", "batched_remove"], [4, 2, 1, "", "insert"], [4, 2, 1, "", "lookup"], [4, 2, 1, "", "remove"]], "lmcache.experimental.lookup_server.abstract_server": [[4, 1, 1, "", "LookupServerInterface"]], "lmcache.experimental.lookup_server.abstract_server.LookupServerInterface": [[4, 2, 1, "", "batched_remove"], [4, 2, 1, "", "insert"], [4, 2, 1, "", "lookup"], [4, 2, 1, "", "remove"]], "lmcache.experimental.lookup_server.redis_server": [[4, 1, 1, "", "RedisLookupServer"]], "lmcache.experimental.lookup_server.redis_server.RedisLookupServer": [[4, 2, 1, "", "batched_remove"], [4, 2, 1, "", "insert"], [4, 2, 1, "", "lookup"], [4, 2, 1, "", "remove"]], "lmcache.experimental.memory_management": [[2, 1, 1, "", "BufferAllocator"], [2, 1, 1, "", "BytesBufferMemoryObj"], [2, 1, 1, "", "FreeBlock"], [2, 1, 1, "", "GPUMemoryAllocator"], [2, 1, 1, "", "HostMemoryAllocator"], [2, 1, 1, "", "MemoryAllocatorInterface"], [2, 1, 1, "", "MemoryFormat"], [2, 1, 1, "", "MemoryObj"], [2, 1, 1, "", "MemoryObjMetadata"], [2, 1, 1, "", "MixedMemoryAllocator"], [2, 1, 1, "", "PinMemoryAllocator"], [2, 1, 1, "", "TensorMemoryAllocator"], [2, 1, 1, "", "TensorMemoryObj"]], "lmcache.experimental.memory_management.BufferAllocator": [[2, 2, 1, "", "allocate"], [2, 2, 1, "", "free"], [2, 2, 1, "", "get_ref_count"], [2, 2, 1, "", "memcheck"], [2, 2, 1, "", "ref_count_down"], [2, 2, 1, "", "ref_count_up"]], "lmcache.experimental.memory_management.BytesBufferMemoryObj": [[2, 5, 1, "", "byte_array"], [2, 2, 1, "", "get_dtype"], [2, 2, 1, "", "get_memory_format"], [2, 2, 1, "", "get_physical_size"], [2, 2, 1, "", "get_shape"], [2, 2, 1, "", "get_size"], [2, 2, 1, "", "invalidate"], [2, 2, 1, "", "is_valid"], [2, 5, 1, "", "metadata"], [2, 5, 1, "", "tensor"]], "lmcache.experimental.memory_management.FreeBlock": [[2, 2, 1, "", "can_be_coalesced"], [2, 4, 1, "", "size"], [2, 4, 1, "", "start"]], "lmcache.experimental.memory_management.GPUMemoryAllocator": [[2, 2, 1, "", "allocate"], [2, 2, 1, "", "free"], [2, 2, 1, "", "get_ref_count"], [2, 2, 1, "", "memcheck"], [2, 2, 1, "", "ref_count_down"], [2, 2, 1, "", "ref_count_up"]], "lmcache.experimental.memory_management.HostMemoryAllocator": [[2, 2, 1, "", "allocate"], [2, 2, 1, "", "free"], [2, 2, 1, "", "get_ref_count"], [2, 2, 1, "", "memcheck"], [2, 2, 1, "", "ref_count_down"], [2, 2, 1, "", "ref_count_up"]], "lmcache.experimental.memory_management.MemoryAllocatorInterface": [[2, 2, 1, "", "allocate"], [2, 2, 1, "", "free"], [2, 2, 1, "", "get_ref_count"], [2, 2, 1, "", "ref_count_down"], [2, 2, 1, "", "ref_count_up"]], "lmcache.experimental.memory_management.MemoryFormat": [[2, 4, 1, "", "BINARY"], [2, 4, 1, "", "BINARY_BUFFER"], [2, 4, 1, "", "KV_BLOB"], [2, 4, 1, "", "UNDEFINED"], [2, 2, 1, "", "token_dim"]], "lmcache.experimental.memory_management.MemoryObj": [[2, 5, 1, "", "byte_array"], [2, 2, 1, "", "get_dtype"], [2, 2, 1, "", "get_memory_format"], [2, 2, 1, "", "get_physical_size"], [2, 2, 1, "", "get_shape"], [2, 2, 1, "", "get_size"], [2, 2, 1, "", "invalidate"], [2, 2, 1, "", "is_valid"], [2, 5, 1, "", "metadata"], [2, 5, 1, "", "tensor"]], "lmcache.experimental.memory_management.MemoryObjMetadata": [[2, 4, 1, "", "address"], [2, 4, 1, "", "dtype"], [2, 4, 1, "", "fmt"], [2, 4, 1, "", "phy_size"], [2, 4, 1, "", "ref_count"], [2, 4, 1, "", "shape"]], "lmcache.experimental.memory_management.MixedMemoryAllocator": [[2, 2, 1, "", "allocate"], [2, 2, 1, "", "free"], [2, 2, 1, "", "get_ref_count"], [2, 2, 1, "", "memcheck"], [2, 2, 1, "", "ref_count_down"], [2, 2, 1, "", "ref_count_up"]], "lmcache.experimental.memory_management.PinMemoryAllocator": [[2, 2, 1, "", "allocate"], [2, 2, 1, "", "free"], [2, 2, 1, "", "get_ref_count"], [2, 2, 1, "", "memcheck"], [2, 2, 1, "", "ref_count_down"], [2, 2, 1, "", "ref_count_up"]], "lmcache.experimental.memory_management.TensorMemoryAllocator": [[2, 4, 1, "", "ALIGN_BYTES"], [2, 2, 1, "", "allocate"], [2, 2, 1, "", "free"], [2, 2, 1, "", "get_ref_count"], [2, 2, 1, "", "memcheck"], [2, 2, 1, "", "ref_count_down"], [2, 2, 1, "", "ref_count_up"]], "lmcache.experimental.memory_management.TensorMemoryObj": [[2, 5, 1, "", "byte_array"], [2, 2, 1, "", "get_dtype"], [2, 2, 1, "", "get_memory_format"], [2, 2, 1, "", "get_physical_size"], [2, 2, 1, "", "get_shape"], [2, 2, 1, "", "get_size"], [2, 2, 1, "", "invalidate"], [2, 2, 1, "", "is_valid"], [2, 5, 1, "", "metadata"], [2, 5, 1, "", "tensor"]], "lmcache.experimental.server": [[6, 0, 0, "-", "storage_backend"], [5, 0, 0, "-", "utils"]], "lmcache.experimental.server.storage_backend": [[6, 3, 1, "", "CreateStorageBackend"], [6, 0, 0, "-", "abstract_backend"], [6, 0, 0, "-", "local_backend"]], "lmcache.experimental.server.storage_backend.abstract_backend": [[6, 1, 1, "", "LMSBackendInterface"]], "lmcache.experimental.server.storage_backend.abstract_backend.LMSBackendInterface": [[6, 2, 1, "", "close"], [6, 2, 1, "", "contains"], [6, 2, 1, "", "get"], [6, 2, 1, "", "list_keys"], [6, 2, 1, "", "put"]], "lmcache.experimental.server.storage_backend.local_backend": [[6, 1, 1, "", "LMSLocalBackend"]], "lmcache.experimental.server.storage_backend.local_backend.LMSLocalBackend": [[6, 2, 1, "", "close"], [6, 2, 1, "", "contains"], [6, 2, 1, "", "get"], [6, 2, 1, "", "list_keys"], [6, 2, 1, "", "put"], [6, 2, 1, "", "remove"]], "lmcache.experimental.server.utils": [[5, 1, 1, "", "LMSMemoryObj"]], "lmcache.experimental.server.utils.LMSMemoryObj": [[5, 4, 1, "", "data"], [5, 4, 1, "", "dtype"], [5, 4, 1, "", "fmt"], [5, 4, 1, "", "length"], [5, 4, 1, "", "shape"]], "lmcache.experimental.storage_backend": [[7, 3, 1, "", "CreateStorageBackends"], [7, 0, 0, "-", "abstract_backend"], [8, 0, 0, "-", "connector"], [9, 0, 0, "-", "evictor"], [7, 0, 0, "-", "local_disk_backend"], [10, 0, 0, "-", "naive_serde"], [7, 0, 0, "-", "storage_manager"]], "lmcache.experimental.storage_backend.abstract_backend": [[7, 1, 1, "", "StorageBackendInterface"]], "lmcache.experimental.storage_backend.abstract_backend.StorageBackendInterface": [[7, 2, 1, "", "close"], [7, 2, 1, "", "contains"], [7, 2, 1, "", "exists_in_put_tasks"], [7, 2, 1, "", "get_blocking"], [7, 2, 1, "", "submit_prefetch_task"], [7, 2, 1, "", "submit_put_task"]], "lmcache.experimental.storage_backend.connector": [[8, 3, 1, "", "CreateConnector"], [8, 1, 1, "", "ParsedRemoteURL"], [8, 0, 0, "-", "base_connector"], [8, 0, 0, "-", "infinistore_connector"], [8, 0, 0, "-", "lm_connector"], [8, 3, 1, "", "parse_remote_url"], [8, 0, 0, "-", "redis_connector"]], "lmcache.experimental.storage_backend.connector.ParsedRemoteURL": [[8, 4, 1, "", "connector_type"], [8, 4, 1, "", "hosts"], [8, 4, 1, "", "ports"]], "lmcache.experimental.storage_backend.connector.base_connector": [[8, 1, 1, "", "RemoteConnector"]], "lmcache.experimental.storage_backend.connector.base_connector.RemoteConnector": [[8, 2, 1, "", "close"], [8, 2, 1, "", "exists"], [8, 2, 1, "", "get"], [8, 2, 1, "", "list"], [8, 2, 1, "", "put"]], "lmcache.experimental.storage_backend.connector.infinistore_connector": [[8, 1, 1, "", "InfinistoreConnector"]], "lmcache.experimental.storage_backend.connector.infinistore_connector.InfinistoreConnector": [[8, 2, 1, "", "close"], [8, 2, 1, "", "exists"], [8, 2, 1, "", "get"], [8, 2, 1, "", "list"], [8, 2, 1, "", "put"]], "lmcache.experimental.storage_backend.connector.lm_connector": [[8, 1, 1, "", "LMCServerConnector"]], "lmcache.experimental.storage_backend.connector.lm_connector.LMCServerConnector": [[8, 2, 1, "", "close"], [8, 2, 1, "", "exists"], [8, 2, 1, "", "get"], [8, 2, 1, "", "list"], [8, 2, 1, "", "put"], [8, 2, 1, "", "receive_all"]], "lmcache.experimental.storage_backend.connector.redis_connector": [[8, 1, 1, "", "RedisConnector"], [8, 1, 1, "", "RedisSentinelConnector"]], "lmcache.experimental.storage_backend.connector.redis_connector.RedisConnector": [[8, 2, 1, "", "close"], [8, 2, 1, "", "exists"], [8, 2, 1, "", "get"], [8, 2, 1, "", "list"], [8, 2, 1, "", "put"]], "lmcache.experimental.storage_backend.connector.redis_connector.RedisSentinelConnector": [[8, 4, 1, "", "ENV_REDIS_SERVICE_NAME"], [8, 4, 1, "", "ENV_REDIS_TIMEOUT"], [8, 2, 1, "", "close"], [8, 2, 1, "", "exists"], [8, 2, 1, "", "get"], [8, 2, 1, "", "list"], [8, 2, 1, "", "put"]], "lmcache.experimental.storage_backend.evictor": [[9, 1, 1, "", "LRUEvictor"], [9, 1, 1, "", "PutStatus"], [9, 0, 0, "-", "base_evictor"], [9, 0, 0, "-", "lru_evictor"]], "lmcache.experimental.storage_backend.evictor.LRUEvictor": [[9, 2, 1, "", "update_on_hit"], [9, 2, 1, "", "update_on_put"]], "lmcache.experimental.storage_backend.evictor.PutStatus": [[9, 4, 1, "", "ILLEGAL"], [9, 4, 1, "", "LEGAL"]], "lmcache.experimental.storage_backend.evictor.base_evictor": [[9, 1, 1, "", "BaseEvictor"], [9, 1, 1, "", "PutStatus"]], "lmcache.experimental.storage_backend.evictor.base_evictor.BaseEvictor": [[9, 2, 1, "", "update_on_hit"], [9, 2, 1, "", "update_on_put"]], "lmcache.experimental.storage_backend.evictor.base_evictor.PutStatus": [[9, 4, 1, "", "ILLEGAL"], [9, 4, 1, "", "LEGAL"]], "lmcache.experimental.storage_backend.evictor.lru_evictor": [[9, 1, 1, "", "LRUEvictor"]], "lmcache.experimental.storage_backend.evictor.lru_evictor.LRUEvictor": [[9, 2, 1, "", "update_on_hit"], [9, 2, 1, "", "update_on_put"]], "lmcache.experimental.storage_backend.local_disk_backend": [[7, 1, 1, "", "LocalDiskBackend"]], "lmcache.experimental.storage_backend.local_disk_backend.LocalDiskBackend": [[7, 2, 1, "", "async_load_bytes_from_disk"], [7, 2, 1, "", "async_save_bytes_to_disk"], [7, 2, 1, "", "close"], [7, 2, 1, "", "contains"], [7, 2, 1, "", "exists_in_put_tasks"], [7, 2, 1, "", "get_blocking"], [7, 2, 1, "", "insert_key"], [7, 2, 1, "", "load_bytes_from_disk"], [7, 2, 1, "", "load_disk"], [7, 2, 1, "", "remove"], [7, 2, 1, "", "submit_prefetch_task"], [7, 2, 1, "", "submit_put_task"]], "lmcache.experimental.storage_backend.naive_serde": [[10, 3, 1, "", "CreateSerde"], [10, 1, 1, "", "Deserializer"], [10, 1, 1, "", "KIVIDeserializer"], [10, 1, 1, "", "KIVISerializer"], [10, 1, 1, "", "Serializer"], [10, 0, 0, "-", "cachegen_basics"], [10, 0, 0, "-", "cachegen_decoder"], [10, 0, 0, "-", "cachegen_encoder"], [10, 0, 0, "-", "kivi_serde"], [10, 0, 0, "-", "naive_serde"], [10, 0, 0, "-", "serde"]], "lmcache.experimental.storage_backend.naive_serde.Deserializer": [[10, 2, 1, "", "deserialize"]], "lmcache.experimental.storage_backend.naive_serde.KIVIDeserializer": [[10, 2, 1, "", "deserialize"]], "lmcache.experimental.storage_backend.naive_serde.KIVISerializer": [[10, 2, 1, "", "serialize"]], "lmcache.experimental.storage_backend.naive_serde.Serializer": [[10, 2, 1, "", "serialize"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_basics": [[10, 1, 1, "", "CacheGenConfig"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_basics.CacheGenConfig": [[10, 2, 1, "", "from_model_name"], [10, 4, 1, "", "kspecs"], [10, 4, 1, "", "nlayers"], [10, 4, 1, "", "vspecs"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_decoder": [[10, 1, 1, "", "CacheGenDeserializer"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_decoder.CacheGenDeserializer": [[10, 2, 1, "", "deserialize"], [10, 2, 1, "", "get_output_buffer"], [10, 2, 1, "", "make_key_bins"], [10, 2, 1, "", "make_value_bins"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_encoder": [[10, 1, 1, "", "CacheGenSerializer"]], "lmcache.experimental.storage_backend.naive_serde.cachegen_encoder.CacheGenSerializer": [[10, 2, 1, "", "make_key_bins"], [10, 2, 1, "", "make_value_bins"], [10, 2, 1, "", "serialize"]], "lmcache.experimental.storage_backend.naive_serde.kivi_serde": [[10, 1, 1, "", "KIVIDeserializer"], [10, 1, 1, "", "KIVISerializer"]], "lmcache.experimental.storage_backend.naive_serde.kivi_serde.KIVIDeserializer": [[10, 2, 1, "", "deserialize"]], "lmcache.experimental.storage_backend.naive_serde.kivi_serde.KIVISerializer": [[10, 2, 1, "", "serialize"]], "lmcache.experimental.storage_backend.naive_serde.naive_serde": [[10, 1, 1, "", "NaiveDeserializer"], [10, 1, 1, "", "NaiveSerializer"]], "lmcache.experimental.storage_backend.naive_serde.naive_serde.NaiveDeserializer": [[10, 2, 1, "", "deserialize"]], "lmcache.experimental.storage_backend.naive_serde.naive_serde.NaiveSerializer": [[10, 2, 1, "", "serialize"]], "lmcache.experimental.storage_backend.naive_serde.serde": [[10, 1, 1, "", "Deserializer"], [10, 1, 1, "", "Serializer"]], "lmcache.experimental.storage_backend.naive_serde.serde.Deserializer": [[10, 2, 1, "", "deserialize"]], "lmcache.experimental.storage_backend.naive_serde.serde.Serializer": [[10, 2, 1, "", "serialize"]], "lmcache.experimental.storage_backend.storage_manager": [[7, 1, 1, "", "StorageManager"]], "lmcache.experimental.storage_backend.storage_manager.StorageManager": [[7, 2, 1, "", "allocate"], [7, 2, 1, "", "close"], [7, 2, 1, "", "contains"], [7, 2, 1, "", "get"], [7, 2, 1, "", "prefetch"], [7, 2, 1, "", "prefetch_callback"], [7, 2, 1, "", "put"]], "lmcache.experimental.token_database": [[2, 1, 1, "", "ChunkedTokenDatabase"], [2, 1, 1, "", "TokenDatabase"]], "lmcache.experimental.token_database.ChunkedTokenDatabase": [[2, 2, 1, "", "process_tokens"]], "lmcache.experimental.token_database.TokenDatabase": [[2, 2, 1, "", "process_tokens"]], "lmcache.integration": [[12, 0, 0, "-", "vllm"]], "lmcache.integration.vllm": [[12, 0, 0, "-", "utils"], [12, 0, 0, "-", "vllm_adapter"]], "lmcache.integration.vllm.utils": [[12, 3, 1, "", "lmcache_get_config"]], "lmcache.integration.vllm.vllm_adapter": [[12, 1, 1, "", "ModelInputSubset"], [12, 1, 1, "", "RetrieveStatus"], [12, 1, 1, "", "StoreStatus"], [12, 3, 1, "", "broadcast_seq_group_list"], [12, 3, 1, "", "broadcast_seq_group_metadata"], [12, 3, 1, "", "build_partial_prefill_input"], [12, 3, 1, "", "close_lmcache_engine"], [12, 3, 1, "", "create_model_input_subset"], [12, 3, 1, "", "init_lmcache_engine"], [12, 3, 1, "", "lmcache_retrieve_kv"], [12, 3, 1, "", "lmcache_should_retrieve"], [12, 3, 1, "", "lmcache_should_store"], [12, 3, 1, "", "lmcache_store_kv"]], "lmcache.integration.vllm.vllm_adapter.ModelInputSubset": [[12, 4, 1, "", "attn_layers"], [12, 4, 1, "", "end_layer"], [12, 4, 1, "", "model_layers"], [12, 4, 1, "", "start_layer"]], "lmcache.integration.vllm.vllm_adapter.RetrieveStatus": [[12, 4, 1, "", "CHUNK_PREFILL"], [12, 4, 1, "", "CHUNK_PREFILL_LAST"], [12, 4, 1, "", "NONE"], [12, 4, 1, "", "PREFILL"]], "lmcache.integration.vllm.vllm_adapter.StoreStatus": [[12, 4, 1, "", "CHUNK_PREFILL"], [12, 4, 1, "", "DECODE"], [12, 4, 1, "", "NONE"], [12, 4, 1, "", "PREFILL"], [12, 4, 1, "", "SUFFIX_PREFILL"]], "lmcache.logging": [[0, 3, 1, "", "init_logger"]], "lmcache.protocol": [[0, 1, 1, "", "ClientMetaMessage"], [0, 1, 1, "", "Constants"], [0, 1, 1, "", "ServerMetaMessage"]], "lmcache.protocol.ClientMetaMessage": [[0, 4, 1, "", "command"], [0, 2, 1, "", "deserialize"], [0, 4, 1, "", "key"], [0, 4, 1, "", "length"], [0, 2, 1, "", "packlength"], [0, 2, 1, "", "serialize"]], "lmcache.protocol.Constants": [[0, 4, 1, "", "CLIENT_EXIST"], [0, 4, 1, "", "CLIENT_GET"], [0, 4, 1, "", "CLIENT_LIST"], [0, 4, 1, "", "CLIENT_PUT"], [0, 4, 1, "", "SERVER_FAIL"], [0, 4, 1, "", "SERVER_SUCCESS"]], "lmcache.protocol.ServerMetaMessage": [[0, 4, 1, "", "code"], [0, 2, 1, "", "deserialize"], [0, 4, 1, "", "length"], [0, 2, 1, "", "packlength"], [0, 2, 1, "", "serialize"]], "lmcache.server.server_storage_backend": [[14, 0, 0, "-", "abstract_backend"], [14, 0, 0, "-", "local_backend"]], "lmcache.server.server_storage_backend.abstract_backend": [[14, 1, 1, "", "LMSBackendInterface"]], "lmcache.server.server_storage_backend.abstract_backend.LMSBackendInterface": [[14, 2, 1, "", "close"], [14, 2, 1, "", "contains"], [14, 2, 1, "", "get"], [14, 2, 1, "", "list_keys"], [14, 2, 1, "", "put"]], "lmcache.server.server_storage_backend.local_backend": [[14, 1, 1, "", "LMSLocalBackend"], [14, 1, 1, "", "LMSLocalDiskBackend"]], "lmcache.server.server_storage_backend.local_backend.LMSLocalBackend": [[14, 2, 1, "", "close"], [14, 2, 1, "", "contains"], [14, 2, 1, "", "get"], [14, 2, 1, "", "list_keys"], [14, 2, 1, "", "put"], [14, 2, 1, "", "remove"]], "lmcache.server.server_storage_backend.local_backend.LMSLocalDiskBackend": [[14, 2, 1, "", "close"], [14, 2, 1, "", "contains"], [14, 2, 1, "", "get"], [14, 2, 1, "", "list_keys"], [14, 2, 1, "", "put"], [14, 2, 1, "", "remove"]], "lmcache.storage_backend": [[26, 0, 0, "-", "abstract_backend"], [17, 0, 0, "-", "evictor"], [15, 0, 0, "-", "hybrid_backend"], [15, 0, 0, "-", "local_backend"], [18, 0, 0, "-", "mem_pool"], [15, 0, 0, "-", "remote_backend"]], "lmcache.storage_backend.abstract_backend": [[26, 1, 1, "", "LMCBackendInterface"]], "lmcache.storage_backend.abstract_backend.LMCBackendInterface": [[26, 2, 1, "", "batched_get"], [26, 2, 1, "", "batched_put"], [26, 2, 1, "", "close"], [26, 2, 1, "", "contains"], [26, 2, 1, "", "get"], [26, 2, 1, "", "put"]], "lmcache.storage_backend.connector": [[16, 0, 0, "-", "base_connector"], [16, 0, 0, "-", "lm_connector"], [16, 0, 0, "-", "redis_connector"]], "lmcache.storage_backend.connector.base_connector": [[16, 1, 1, "", "ConnectorType"], [16, 1, 1, "", "RemoteBytesConnector"], [16, 1, 1, "", "RemoteConnector"], [16, 1, 1, "", "RemoteConnectorDebugWrapper"], [16, 1, 1, "", "RemoteTensorConnector"], [16, 3, 1, "", "check_connector_type"]], "lmcache.storage_backend.connector.base_connector.ConnectorType": [[16, 4, 1, "", "BYTES"], [16, 4, 1, "", "TENSOR"]], "lmcache.storage_backend.connector.base_connector.RemoteConnector": [[16, 2, 1, "", "close"], [16, 2, 1, "", "exists"], [16, 2, 1, "", "get"], [16, 2, 1, "", "list"], [16, 2, 1, "", "set"]], "lmcache.storage_backend.connector.base_connector.RemoteConnectorDebugWrapper": [[16, 2, 1, "", "close"], [16, 2, 1, "", "exists"], [16, 2, 1, "", "get"], [16, 2, 1, "", "list"], [16, 2, 1, "", "set"]], "lmcache.storage_backend.connector.lm_connector": [[16, 1, 1, "", "LMCServerConnector"]], "lmcache.storage_backend.connector.lm_connector.LMCServerConnector": [[16, 2, 1, "", "close"], [16, 2, 1, "", "exists"], [16, 2, 1, "", "get"], [16, 2, 1, "", "list"], [16, 2, 1, "", "receive_all"], [16, 2, 1, "", "send_all"], [16, 2, 1, "", "set"]], "lmcache.storage_backend.connector.redis_connector": [[16, 1, 1, "", "RedisConnector"], [16, 1, 1, "", "RedisSentinelConnector"]], "lmcache.storage_backend.connector.redis_connector.RedisConnector": [[16, 2, 1, "", "close"], [16, 2, 1, "", "exists"], [16, 2, 1, "", "get"], [16, 2, 1, "", "list"], [16, 2, 1, "", "set"]], "lmcache.storage_backend.connector.redis_connector.RedisSentinelConnector": [[16, 4, 1, "", "ENV_REDIS_SERVICE_NAME"], [16, 4, 1, "", "ENV_REDIS_TIMEOUT"], [16, 2, 1, "", "close"], [16, 2, 1, "", "exists"], [16, 2, 1, "", "get"], [16, 2, 1, "", "list"], [16, 2, 1, "", "set"]], "lmcache.storage_backend.evictor": [[17, 1, 1, "", "DummyEvictor"], [17, 1, 1, "", "LRUEvictor"], [17, 0, 0, "-", "base_evictor"], [17, 0, 0, "-", "lru_evictor"]], "lmcache.storage_backend.evictor.DummyEvictor": [[17, 2, 1, "", "update_on_get"], [17, 2, 1, "", "update_on_put"]], "lmcache.storage_backend.evictor.LRUEvictor": [[17, 2, 1, "", "update_on_get"], [17, 2, 1, "", "update_on_put"]], "lmcache.storage_backend.evictor.base_evictor": [[17, 1, 1, "", "BaseEvictor"], [17, 1, 1, "", "DummyEvictor"], [17, 1, 1, "", "PutStatus"]], "lmcache.storage_backend.evictor.base_evictor.BaseEvictor": [[17, 2, 1, "", "get_size"], [17, 2, 1, "", "update_on_get"], [17, 2, 1, "", "update_on_put"]], "lmcache.storage_backend.evictor.base_evictor.DummyEvictor": [[17, 2, 1, "", "update_on_get"], [17, 2, 1, "", "update_on_put"]], "lmcache.storage_backend.evictor.base_evictor.PutStatus": [[17, 4, 1, "", "ILLEGAL"], [17, 4, 1, "", "LEGAL"]], "lmcache.storage_backend.evictor.lru_evictor": [[17, 1, 1, "", "LRUEvictor"]], "lmcache.storage_backend.evictor.lru_evictor.LRUEvictor": [[17, 2, 1, "", "update_on_get"], [17, 2, 1, "", "update_on_put"]], "lmcache.storage_backend.hybrid_backend": [[15, 1, 1, "", "LMCHybridBackend"]], "lmcache.storage_backend.hybrid_backend.LMCHybridBackend": [[15, 2, 1, "", "batched_get"], [15, 2, 1, "", "close"], [15, 2, 1, "", "contains"], [15, 2, 1, "", "get"], [15, 2, 1, "", "put"]], "lmcache.storage_backend.local_backend": [[15, 1, 1, "", "LMCLocalBackend"], [15, 1, 1, "", "LMCLocalDiskBackend"], [15, 1, 1, "", "LocalBackendEndSignal"], [15, 3, 1, "", "save_disk"]], "lmcache.storage_backend.local_backend.LMCLocalBackend": [[15, 2, 1, "", "close"], [15, 2, 1, "", "contains"], [15, 2, 1, "", "get"], [15, 2, 1, "", "put"], [15, 2, 1, "", "put_blocking"], [15, 2, 1, "", "put_nonblocking"], [15, 2, 1, "", "put_worker"], [15, 2, 1, "", "remove"]], "lmcache.storage_backend.local_backend.LMCLocalDiskBackend": [[15, 2, 1, "", "buffer_sweeper"], [15, 2, 1, "", "close"], [15, 2, 1, "", "contains"], [15, 2, 1, "", "get"], [15, 2, 1, "", "put"], [15, 2, 1, "", "put_blocking"], [15, 2, 1, "", "put_nonblocking"], [15, 2, 1, "", "put_worker"], [15, 2, 1, "", "remove"]], "lmcache.storage_backend.mem_pool": [[18, 1, 1, "", "KVObj"], [18, 1, 1, "", "LocalCPUBufferPool"], [18, 1, 1, "", "LocalCPUPool"], [18, 1, 1, "", "LocalGPUPool"], [18, 1, 1, "", "LocalPool"], [18, 0, 0, "-", "base_pool"], [18, 0, 0, "-", "local_pool"]], "lmcache.storage_backend.mem_pool.KVObj": [[18, 4, 1, "", "chunk_idx"], [18, 4, 1, "", "data"], [18, 4, 1, "", "size"]], "lmcache.storage_backend.mem_pool.LocalCPUBufferPool": [[18, 2, 1, "", "allocate"]], "lmcache.storage_backend.mem_pool.LocalPool": [[18, 2, 1, "", "allocate"], [18, 2, 1, "", "free"], [18, 2, 1, "", "init_max_chunk_num"]], "lmcache.storage_backend.mem_pool.base_pool": [[18, 1, 1, "", "BasePool"], [18, 1, 1, "", "KVObj"]], "lmcache.storage_backend.mem_pool.base_pool.BasePool": [[18, 2, 1, "", "allocate"], [18, 2, 1, "", "free"]], "lmcache.storage_backend.mem_pool.base_pool.KVObj": [[18, 4, 1, "", "chunk_idx"], [18, 4, 1, "", "data"], [18, 4, 1, "", "size"]], "lmcache.storage_backend.mem_pool.local_pool": [[18, 1, 1, "", "LocalCPUBufferPool"], [18, 1, 1, "", "LocalCPUPool"], [18, 1, 1, "", "LocalGPUPool"], [18, 1, 1, "", "LocalPool"]], "lmcache.storage_backend.mem_pool.local_pool.LocalCPUBufferPool": [[18, 2, 1, "", "allocate"]], "lmcache.storage_backend.mem_pool.local_pool.LocalPool": [[18, 2, 1, "", "allocate"], [18, 2, 1, "", "free"], [18, 2, 1, "", "init_max_chunk_num"]], "lmcache.storage_backend.remote_backend": [[15, 1, 1, "", "LMCPipelinedRemoteBackend"], [15, 1, 1, "", "LMCRemoteBackend"], [15, 1, 1, "", "RemoteBackendEndSignal"]], "lmcache.storage_backend.remote_backend.LMCPipelinedRemoteBackend": [[15, 2, 1, "", "batched_get"], [15, 2, 1, "", "close"], [15, 2, 1, "", "deserialize_worker"], [15, 2, 1, "", "network_worker"]], "lmcache.storage_backend.remote_backend.LMCRemoteBackend": [[15, 2, 1, "", "close"], [15, 2, 1, "", "contains"], [15, 2, 1, "", "get"], [15, 2, 1, "", "list"], [15, 2, 1, "", "put"], [15, 2, 1, "", "put_blocking"], [15, 2, 1, "", "put_worker"]], "lmcache.storage_backend.serde": [[19, 0, 0, "-", "cachegen_basics"], [19, 0, 0, "-", "cachegen_decoder"], [19, 0, 0, "-", "cachegen_encoder"], [19, 0, 0, "-", "fast_serde"], [19, 0, 0, "-", "safe_serde"], [19, 0, 0, "-", "serde"], [19, 0, 0, "-", "torch_serde"]], "lmcache.storage_backend.serde.cachegen_basics": [[19, 1, 1, "", "CacheGenConfig"], [19, 1, 1, "", "CacheGenEncoderOutput"], [19, 1, 1, "", "CacheGenGPUBytestream"], [19, 1, 1, "", "CacheGenGPUEncoderOutput"], [19, 1, 1, "", "QuantizationSpec"]], "lmcache.storage_backend.serde.cachegen_basics.CacheGenConfig": [[19, 2, 1, "", "from_model_name"], [19, 4, 1, "", "kspecs"], [19, 4, 1, "", "nlayers"], [19, 4, 1, "", "vspecs"]], "lmcache.storage_backend.serde.cachegen_basics.CacheGenEncoderOutput": [[19, 4, 1, "", "bytestream"], [19, 4, 1, "", "cdf"], [19, 2, 1, "", "from_bytes"], [19, 4, 1, "", "head_size"], [19, 4, 1, "", "max_tensors_key"], [19, 4, 1, "", "max_tensors_value"], [19, 4, 1, "", "num_heads"], [19, 4, 1, "", "start_indices"], [19, 2, 1, "", "to_bytes"]], "lmcache.storage_backend.serde.cachegen_basics.CacheGenGPUBytestream": [[19, 4, 1, "", "bytestream"], [19, 4, 1, "", "bytestream_lengths"], [19, 4, 1, "", "ntokens"]], "lmcache.storage_backend.serde.cachegen_basics.CacheGenGPUEncoderOutput": [[19, 4, 1, "", "cdf"], [19, 4, 1, "", "data_chunks"], [19, 2, 1, "", "debug_print_device"], [19, 2, 1, "", "from_bytes"], [19, 4, 1, "", "head_size"], [19, 4, 1, "", "max_tensors_key"], [19, 4, 1, "", "max_tensors_value"], [19, 4, 1, "", "num_heads"], [19, 2, 1, "", "to_bytes"]], "lmcache.storage_backend.serde.cachegen_basics.QuantizationSpec": [[19, 4, 1, "", "bins"], [19, 4, 1, "", "end_layer"], [19, 4, 1, "", "start_layer"]], "lmcache.storage_backend.serde.cachegen_decoder": [[19, 1, 1, "", "CacheGenDeserializer"], [19, 3, 1, "", "decode_chunk"], [19, 3, 1, "", "decode_function_gpu"], [19, 3, 1, "", "do_dequantize"], [19, 3, 1, "", "quant"], [19, 3, 1, "", "recombine_bytes"]], "lmcache.storage_backend.serde.cachegen_decoder.CacheGenDeserializer": [[19, 2, 1, "", "from_bytes"], [19, 2, 1, "", "get_output_buffer"], [19, 2, 1, "", "make_key_bins"], [19, 2, 1, "", "make_value_bins"]], "lmcache.storage_backend.serde.cachegen_encoder": [[19, 1, 1, "", "CacheGenEncoderImpl"], [19, 1, 1, "", "CacheGenSerializer"], [19, 3, 1, "", "collect_bytes"], [19, 3, 1, "", "concat_max"], [19, 3, 1, "", "encode_function"], [19, 3, 1, "", "encode_ntokens"], [19, 3, 1, "", "torch_quant"], [19, 3, 1, "", "torch_quant_vectorized"]], "lmcache.storage_backend.serde.cachegen_encoder.CacheGenEncoderImpl": [[19, 2, 1, "", "compute_cdf"], [19, 2, 1, "", "quantize"]], "lmcache.storage_backend.serde.cachegen_encoder.CacheGenSerializer": [[19, 2, 1, "", "make_key_bins"], [19, 2, 1, "", "make_value_bins"], [19, 2, 1, "", "to_bytes"]], "lmcache.storage_backend.serde.fast_serde": [[19, 1, 1, "", "FastDeserializer"], [19, 1, 1, "", "FastSerializer"]], "lmcache.storage_backend.serde.fast_serde.FastDeserializer": [[19, 2, 1, "", "from_bytes"], [19, 2, 1, "", "from_bytes_normal"]], "lmcache.storage_backend.serde.fast_serde.FastSerializer": [[19, 2, 1, "", "to_bytes"]], "lmcache.storage_backend.serde.safe_serde": [[19, 1, 1, "", "SafeDeserializer"], [19, 1, 1, "", "SafeSerializer"]], "lmcache.storage_backend.serde.safe_serde.SafeDeserializer": [[19, 2, 1, "", "from_bytes"], [19, 2, 1, "", "from_bytes_normal"]], "lmcache.storage_backend.serde.safe_serde.SafeSerializer": [[19, 2, 1, "", "to_bytes"]], "lmcache.storage_backend.serde.serde": [[19, 1, 1, "", "Deserializer"], [19, 1, 1, "", "DeserializerDebugWrapper"], [19, 1, 1, "", "Serializer"], [19, 1, 1, "", "SerializerDebugWrapper"]], "lmcache.storage_backend.serde.serde.Deserializer": [[19, 2, 1, "", "from_bytes"]], "lmcache.storage_backend.serde.serde.DeserializerDebugWrapper": [[19, 2, 1, "", "from_bytes"]], "lmcache.storage_backend.serde.serde.Serializer": [[19, 2, 1, "", "to_bytes"]], "lmcache.storage_backend.serde.serde.SerializerDebugWrapper": [[19, 2, 1, "", "to_bytes"]], "lmcache.storage_backend.serde.torch_serde": [[19, 1, 1, "", "TorchDeserializer"], [19, 1, 1, "", "TorchSerializer"]], "lmcache.storage_backend.serde.torch_serde.TorchDeserializer": [[19, 2, 1, "", "from_bytes"], [19, 2, 1, "", "from_bytes_normal"]], "lmcache.storage_backend.serde.torch_serde.TorchSerializer": [[19, 2, 1, "", "to_bytes"]], "lmcache.utils": [[0, 1, 1, "", "CacheEngineKey"], [0, 1, 1, "", "DiskCacheMetadata"], [0, 3, 1, "", "thread_safe"]], "lmcache.utils.CacheEngineKey": [[0, 4, 1, "", "chunk_hash"], [0, 4, 1, "", "fmt"], [0, 2, 1, "", "from_string"], [0, 4, 1, "", "model_name"], [0, 2, 1, "", "to_string"], [0, 4, 1, "", "worker_id"], [0, 4, 1, "", "world_size"]], "lmcache.utils.DiskCacheMetadata": [[0, 4, 1, "", "dtype"], [0, 4, 1, "", "path"], [0, 4, 1, "", "shape"], [0, 4, 1, "", "size"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute", "5": "py:property"}, "terms": {"": [0, 1, 2, 19, 25, 28, 29, 31, 32, 40, 41, 43], "0": [1, 2, 9, 17, 22, 27, 29, 31, 32, 34, 35, 36, 38, 39, 40], "1": [0, 1, 2, 8, 9, 12, 16, 17, 19, 31, 32, 33, 34, 35, 36, 38, 39, 40, 43], "10": [9, 17, 33, 34, 35, 36, 38, 40, 41], "100": [40, 43], "1000": [35, 36], "1024": [32, 34], "10x": 42, "12": 40, "127": 39, "15": 2, "150": 39, "16384": 33, "16k": [32, 40], "1b": 39, "2": [0, 2, 9, 12, 16, 17, 19, 27, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43], "200": 0, "256": [2, 22, 24, 29, 31, 32, 34, 35, 36, 39], "26379": [8, 16, 22, 24], "26380": [8, 16], "26381": [8, 16], "3": [0, 2, 12, 31, 33, 38, 39, 40, 42, 43], "30": 31, "32768": [32, 34], "32k": 43, "3f": 31, "3gb": 41, "4": [0, 12, 40, 41, 43], "400": 0, "4096": [38, 40], "40gb": [35, 36], "5": [2, 12, 22, 24, 35, 36, 39, 43], "512": 2, "5k": 34, "6": 40, "6379": 38, "65432": [2, 22, 24, 29, 32], "6x": 41, "7": [31, 40], "7b": [31, 32, 34, 35, 36, 39, 40, 41, 43], "8": [32, 34, 35, 36, 38, 40], "8000": [24, 32, 33, 35, 36, 38, 39, 40], "8001": [24, 32, 38], "8100": [36, 38], "8200": 38, "8201": 38, "8501": 41, "8b": [33, 38, 40, 43], "95": [31, 32, 34, 35, 36], "9b": 43, "A": [1, 2, 7, 8, 12, 15, 16, 40, 41], "And": [2, 12], "As": [40, 41], "By": 42, "For": [2, 24, 27, 28, 33, 39, 40, 41, 43], "If": [1, 2, 7, 8, 12, 25, 28, 41], "In": [2, 24, 25, 29, 41], "It": [1, 2, 15, 25, 42], "NOT": [1, 14, 15, 26, 27], "On": 2, "The": [1, 2, 7, 8, 12, 14, 15, 16, 19, 22, 24, 25, 26, 27, 28, 29, 32, 33, 34, 35, 36, 38, 39, 41], "Then": 32, "There": [2, 22], "These": 28, "To": [22, 24, 25, 28, 33, 39, 40, 43], "Will": [1, 2, 8, 27], "__init__": 25, "__main__": 36, "__name__": 36, "_blob_to_tuple_kv": 27, "_chunk_kv": 27, "_chunk_token": 27, "_get_init_hash": 27, "_hash": 27, "_log_task_complet": 25, "_make_chunk": 27, "_make_chunks_skip_exist": 27, "_make_kei": 27, "_num_tokens_in_kv": 27, "_prefix_hash": 27, "_slice_kv_at": 27, "_tuple_kv_to_blob": 27, "a40": [35, 36, 41], "a6000": 41, "about": [31, 35, 36], "abov": [31, 32, 34, 39, 41], "abstract": [1, 2, 3, 4, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18, 19, 26], "abstract_backend": [2, 5, 13, 20, 26], "abstracteventloop": [3, 7, 8], "accept": [39, 43], "access": 41, "achiev": 42, "across": [28, 32, 41], "activ": [33, 40], "actual": [18, 25], "ad": [24, 25], "adapt": 25, "add": [25, 40, 43], "addit": [2, 24, 36], "address": 2, "advanc": [2, 31], "after": [1, 7, 8, 12, 25, 27, 28, 41, 43], "ai": [39, 40], "align": 25, "align_byt": 2, "all": [2, 6, 7, 8, 16, 25, 27, 33, 37, 39, 42], "all_reduce_funct": 1, "alloc": [2, 7, 10, 18], "allow": [9, 25, 27], "almost": 41, "along": 28, "alreadi": [2, 25], "also": [1, 2, 15, 24, 31, 33, 34, 40], "although": 40, "alwai": 2, "an": [2, 6, 7, 22, 24, 27, 28, 32, 33, 34, 35, 36, 38, 39, 40], "ani": [19, 36, 42, 43], "anoth": [24, 41], "answer": [31, 34, 41], "api": 40, "app": 41, "append": [31, 32, 34], "append_output": [32, 34], "appendix": 28, "applic": [38, 39], "apply_chat_templ": [32, 34], "ar": [1, 2, 8, 15, 16, 22, 24, 25, 26, 27, 28, 29, 32, 33, 34, 35, 36, 39, 41, 43], "arg": [22, 24, 36], "argument": [2, 27], "around": [34, 41], "arrai": 2, "arriv": 25, "assert": [32, 34], "assertionerror": 2, "assist": [32, 34, 39], "associ": 2, "assum": [1, 25], "async": [1, 3, 7, 8], "async_llm_engin": 25, "async_load_bytes_from_disk": [2, 7], "async_save_bytes_to_disk": [2, 7], "asynchron": 2, "asyncio": 25, "attent": 25, "attn_lay": [11, 12], "automat": 38, "automodelforcausallm": 41, "autotoken": [32, 34, 41], "avail": [1, 25, 39, 40, 41], "avoid": [2, 27, 40], "b": 19, "backend": [0, 2, 7, 20, 22, 24, 25, 27, 28, 30, 33, 35, 36, 40, 41, 42], "backend_typ": 29, "background": 1, "bandwidth": 41, "base": [1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 25, 28, 41, 43], "base_connector": 15, "base_evictor": [2, 7, 15], "base_pool": 15, "baseevictor": [7, 9, 17], "basepool": 18, "bash": [22, 24, 33, 41], "bashrc": 40, "batch": [1, 4, 14, 15, 19, 26, 27], "batched_get": [15, 26], "batched_put": [15, 26], "batched_remov": 4, "becaus": 40, "been": [7, 25], "befor": [14, 15, 25, 26, 29, 40], "being": [2, 7], "below": [27, 33, 40], "better": [1, 33], "between": [25, 36, 41], "big": [14, 15, 26, 27], "bin": [19, 39, 40], "binari": [2, 10, 40], "binary_buff": 2, "bind": 29, "blcock": 7, "blend": [0, 20, 22, 24, 30, 37, 42], "blend_adapt": 31, "blend_min_token": [2, 22], "blend_recompute_ratio": [2, 22], "blendexecutor": 1, "blendoutput": 1, "blendretriev": 1, "blendretrieverresult": 1, "blendretrievertask": 1, "blob": 27, "block": [1, 3, 7, 14, 15, 25, 26, 27], "block_siz": 2, "bool": [2, 6, 7, 8, 12, 14, 15, 16, 22, 24, 25, 26, 27], "boolean": [2, 12, 27], "boost": 34, "bootstrap": 33, "both": [15, 19, 40, 41], "boundari": [2, 9, 12, 16, 17], "break": 27, "bridg": 25, "broadcast": 12, "broadcast_seq_group_list": [11, 12], "broadcast_seq_group_metadata": [11, 12], "browser": 41, "buffer": [2, 18, 19, 36], "buffer_memory_obj": 10, "buffer_s": 19, "buffer_sweep": 15, "bufferalloc": 2, "build": [2, 25], "build_partial_prefill_input": [11, 12, 25], "byte": [0, 2, 7, 14, 16, 17, 19, 36], "byte_arrai": 2, "byte_tensor": 19, "bytearrai": [5, 6, 7, 14, 19], "bytes_tensor": 19, "bytesbuffermemoryobj": [2, 10], "bytestream": 19, "bytestream_length": 19, "c": [40, 41], "cach": [1, 2, 6, 7, 8, 9, 12, 14, 15, 16, 17, 19, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 36, 37, 39, 41, 42], "cache_config": 12, "cache_dict": [9, 17], "cache_dir": 41, "cache_engin": [1, 27, 35, 36], "cache_s": [9, 17], "cacheblend": 1, "cacheblendimpl": 1, "cacheconfig": 12, "cacheengin": 8, "cacheengineendsign": 2, "cacheenginekei": [0, 2, 3, 4, 6, 7, 8, 9, 15, 17, 20, 26, 27], "cachegen": [22, 24, 28, 29, 32, 33, 43], "cachegen_bas": 15, "cachegen_binari": 10, "cachegen_decod": 15, "cachegen_encod": 15, "cachegenconfig": [10, 19], "cachegendeseri": [10, 19], "cachegenencoderimpl": 19, "cachegenencoderoutput": 19, "cachegengpubytestream": 19, "cachegengpuencoderoutput": 19, "cachegenseri": [10, 19], "call": [2, 14, 15, 25, 26, 29, 33], "callabl": 1, "can": [3, 19, 22, 24, 25, 27, 28, 29, 31, 32, 33, 34, 39, 40, 41, 42, 43], "can_be_coalesc": 2, "cancel": 25, "cancellederror": 25, "card": 43, "case": [2, 41, 42], "caus": [40, 41], "cd": [33, 40, 41], "cdf": 19, "cdf_int": 19, "central": 28, "chang": [1, 12, 32], "chat": [39, 43], "check": [2, 7, 8, 12, 14, 15, 16, 25, 27, 28, 33, 37, 40], "check_connector_typ": 16, "children": [6, 14, 15, 26], "chmod": [22, 24, 39], "chunk": [1, 2, 6, 14, 15, 18, 22, 24, 26, 27, 28, 31, 35, 36, 39], "chunk1": 31, "chunk2": 31, "chunk_hash": [0, 20, 27], "chunk_idx": 18, "chunk_kv": 27, "chunk_prefil": [11, 12], "chunk_prefill_last": [11, 12], "chunk_siz": [2, 19, 22, 24, 27, 29, 31, 32, 34, 39], "chunkedtokendatabas": 2, "class": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 25, 26, 27], "classmethod": 2, "clean": [35, 36], "cleanup": [6, 14, 15, 26], "clear": [32, 34], "cli": 25, "client": [3, 6, 25], "client_exist": [0, 20], "client_get": [0, 20], "client_list": [0, 20], "client_meta": 6, "client_put": [0, 20], "client_socket": 3, "clientmetamessag": [0, 6, 20], "clone": [33, 40, 41], "close": [2, 3, 5, 6, 7, 8, 12, 14, 15, 16, 25, 26, 27], "close_lmcache_engin": [11, 12, 25, 31, 32, 34], "cluster": [8, 16], "code": [0, 12, 20, 25, 31, 32, 34, 39, 40, 41], "collect": 19, "collect_byt": 19, "com": [33, 35, 36, 40, 41], "combin": [27, 42], "combine_input_prompt_chunk": 31, "come": [9, 17], "comma": [8, 16], "command": [0, 20, 25, 31, 32, 33, 34, 35, 36, 39, 40], "compar": [33, 41], "compat": 35, "compil": 40, "complet": [14, 15, 26, 28, 38, 39], "compon": [25, 28, 40], "compos": 41, "compress": [2, 10, 36, 43], "comput": [19, 28, 31], "compute_cdf": 19, "concat_max": 19, "concaten": [19, 27], "concis": 32, "conda": [33, 40], "condit": [25, 43], "config": [3, 4, 7, 8, 10, 12, 15, 16, 19, 27, 29, 32, 35, 36, 38, 39, 40], "configur": [2, 12, 25, 29, 35, 36], "conflict": [2, 41], "connect": [8, 16], "connector": [2, 15], "connector_typ": 8, "connectortyp": 16, "consist": [9, 17, 28], "constant": [0, 20], "constitu": 8, "construct": 2, "consum": 2, "contain": [1, 2, 5, 6, 7, 8, 14, 15, 16, 19, 26, 32, 33, 34, 40], "content": [15, 20, 32, 34, 38, 39], "context": [31, 33, 34, 41], "context_fil": [31, 32, 34], "context_length": [32, 34], "context_messag": [32, 34], "context_text": [32, 34], "continu": 25, "control": 0, "convers": 34, "convert": [2, 7, 27], "copi": [2, 32, 34], "copyed_context_messag": [32, 34], "core": 25, "correctli": [25, 40], "correspond": [1, 2, 8, 16, 18, 27, 28], "count": [2, 8], "cpu": [1, 2, 14, 15, 22, 24, 28, 29, 31, 32, 33, 34, 36, 37, 42], "cpu_offload_lmcach": 35, "creat": [1, 2, 8, 29, 32, 33, 34, 40], "create_index": 1, "create_model_input_subset": [11, 12], "createconnector": 8, "createserd": 10, "createstoragebackend": [2, 5, 6, 7], "credenti": 43, "csv": 33, "ctrl": 41, "cuda": [2, 7, 15, 22, 24, 25, 26, 29, 40], "cuda_hom": 40, "cuda_vers": 40, "cuda_visible_devic": [29, 31, 32, 34, 36, 38], "curl": [38, 39], "current": [9, 12, 17, 25, 27, 28, 33], "custom": [25, 28], "cycl": 42, "d": [2, 19, 38, 39, 41], "data": [2, 5, 15, 16, 18, 19, 25], "data_chunk": 19, "debug": 2, "debug_print_devic": 19, "decod": [11, 12, 19, 22, 24, 25, 28, 30, 36, 42], "decode_chunk": 19, "decode_function_gpu": 19, "decode_process": 36, "decompress": [10, 43], "decreas": [2, 8], "deepcopi": [32, 34], "def": [25, 32, 34, 36], "default": [2, 8, 12, 16, 22, 24, 29, 40, 41], "defin": [2, 25, 33], "delai": 42, "delet": 2, "delimit": 1, "demo4": 41, "demonstr": [33, 35, 36, 38], "depend": [27, 40], "deploy": 39, "descript": 32, "deseri": [0, 10, 19, 20, 28, 29, 36], "deserialize_work": 15, "deserializerdebugwrapp": 19, "destroi": [2, 25, 35, 36], "detail": [27, 28, 33, 34], "determin": 25, "dev160": 40, "dev_nam": 8, "devic": [1, 2, 6, 12, 19, 22, 24, 25, 27], "dict": [9, 17, 19], "dictionari": [27, 28], "differ": [2, 19, 28, 29, 33, 41], "dimens": [1, 2, 14, 15, 26, 27, 28], "directli": [8, 16, 40, 43], "directori": 33, "disabl": 36, "disaggreg": [37, 42], "disaggregated_prefill_lmcach": 36, "disk": [7, 14, 15, 28, 29, 41], "diskcachemetadata": [0, 20], "distribut": [24, 38], "distributed_url": [2, 24], "distributedserverinterfac": 3, "do": [6, 7, 14, 15, 22, 24, 26, 43], "do_dequant": 19, "docker": [38, 42], "document": [31, 32, 41, 43], "doe": [2, 7, 8, 16, 18, 31, 41], "doesn": 2, "done": [15, 33, 35], "down": [25, 41], "download": 41, "driver": 12, "driver_work": 12, "drop_spt_and_get_indic": 1, "dst_devic": [7, 15, 26], "dtype": [0, 2, 5, 7, 19, 20], "dummyevictor": 17, "dump": [32, 34], "dure": [1, 25], "dynam": 25, "e": [2, 22, 24, 27, 31, 32, 33, 34, 40, 42], "each": [1, 2, 12, 19, 25, 27, 28, 41, 42], "echo": 41, "effici": [25, 27], "either": 27, "element": 2, "empti": 27, "enabl": [7, 22, 24, 31, 35, 39, 41], "enable_blend": [2, 22, 31], "enable_chunked_prefil": [32, 34, 35], "enable_p2p": [2, 24], "encod": 19, "encode_funct": 19, "encode_input": 19, "encode_ntoken": 19, "end": [1, 2, 19, 30, 42], "end_lay": [11, 12, 19], "enforce_eag": 36, "engin": [1, 2, 8, 12, 14, 15, 16, 26, 28, 38, 41, 42], "engine_nam": [35, 36], "ensur": 25, "enter": 43, "entir": [12, 28], "entri": 25, "entrypoint": 39, "enum": [2, 9, 12, 16, 17], "env": [39, 40, 41], "env_redis_service_nam": [8, 16], "env_redis_timeout": [8, 16], "environ": [2, 8, 12, 16, 21, 23, 33, 35, 36, 40, 41], "etc": 19, "evalu": 25, "event": 36, "everyth": 2, "evict": [7, 9, 17], "evict_kei": 17, "evictor": [2, 7, 15], "exampl": [1, 2, 8, 16, 31, 32, 33, 35, 36, 38, 40], "example1": 38, "example2": 38, "except": [25, 37], "execut": [12, 25], "execute_model": [12, 25], "executor": 20, "exist": [2, 7, 8, 15, 16, 25, 27, 28], "exists_in_put_task": [2, 7], "exit": [25, 31, 32, 34], "expect": [2, 19], "experiment": [24, 35, 36, 40, 42], "explain": 38, "explicit": 2, "explicitli": 2, "export": [22, 24, 40], "extend": 34, "external_url": 41, "extra": [8, 16, 27, 40], "f": [31, 32, 33, 34, 35, 36], "fail": [2, 10], "fals": [2, 8, 14, 15, 16, 22, 24, 29, 32, 34, 35, 36, 39], "fast": [22, 24, 28, 29], "fast_serd": 15, "fastdeseri": 19, "faster": 41, "fastseri": 19, "featur": [24, 35, 36, 37, 40], "fetch": [2, 25, 28], "fffffttttttt": 2, "ffmpeg": [32, 34, 41], "field": 19, "figur": 41, "file": [2, 8, 12, 16, 19, 21, 23, 25, 29, 31, 32, 33, 34, 35, 36, 39, 40], "file_path": 2, "fin": 31, "final": 33, "fine": 2, "finish": [8, 27, 36], "first": [2, 28, 31, 32, 33, 35, 42], "first_output": [32, 34], "first_prompt": 35, "first_scheduled_tim": 31, "first_token_tim": 31, "fix": 19, "flat": 2, "float": [1, 2, 9, 17, 19, 22], "float32": 19, "fmt": [0, 1, 2, 5, 20, 27], "folder": 33, "follow": [22, 24, 25, 29, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43], "fork": 42, "form": 27, "format": [2, 6, 8, 14, 15, 22, 24, 26, 27, 28, 32, 43], "found": [2, 14, 15, 25, 26, 28, 31, 34], "four": 28, "fp_k": 19, "fp_v": 19, "free": [2, 15, 18], "freeblock": 2, "freed": 18, "fresh": 1, "fresh_k": 1, "fresh_q": 1, "fresh_v": 1, "from": [0, 1, 2, 3, 7, 8, 12, 18, 19, 25, 27, 28, 31, 32, 33, 34, 35, 36, 38, 41, 43], "from_byt": 19, "from_bytes_norm": 19, "from_cli": [35, 36], "from_default": 2, "from_env": 2, "from_fil": 2, "from_gpu": 2, "from_legaci": 2, "from_model_nam": [10, 19], "from_pretrain": [32, 34, 40, 41, 43], "from_str": [0, 20], "frontend": 41, "full": [1, 2, 9, 17, 18], "full_prompt": 1, "full_tokens_list": 12, "func": 0, "function": [1, 2, 3, 7, 12, 15, 16, 25, 27, 33], "further": 30, "futur": [1, 7, 15, 24, 25], "g": [2, 22, 24, 27, 31, 32, 33, 34], "g28943d36": 40, "gb": [22, 24, 33, 35, 36], "gen_prompt": [32, 34], "gener": [27, 31, 32, 34, 35, 36, 40, 41, 43], "generated_prompt": [32, 34], "generated_text": [31, 32, 34, 35, 36], "get": [1, 2, 3, 5, 6, 7, 8, 12, 14, 15, 16, 17, 26, 39], "get_block": [2, 7], "get_context_length": [32, 34], "get_dtyp": 2, "get_memory_format": 2, "get_or_cr": 2, "get_output_buff": [10, 19], "get_physical_s": 2, "get_ref_count": 2, "get_shap": 2, "get_siz": [2, 17], "git": [33, 40, 41], "github": [33, 35, 36, 40, 41], "give": 32, "given": [2, 6, 8, 9, 12, 14, 15, 16, 17, 19, 25, 26, 33], "glm": 43, "got": [32, 34], "gpu": [2, 14, 15, 19, 28, 29, 32, 33, 35, 36, 38, 39, 40, 41, 42], "gpu_memory_util": [31, 32, 34, 35, 36], "gpuconnector": 2, "gpuconnectorinterfac": 2, "gpumemoryalloc": 2, "gputensor": 2, "grace": [31, 32, 34], "gracefulli": 25, "group": 19, "guid": 33, "h": [38, 39], "ha": [1, 7, 24, 25, 27, 35, 36, 37, 40], "handl": [3, 7], "handle_cli": 3, "handle_get": 3, "happen": [1, 25], "hash": [2, 14, 15, 26, 27], "hasn": 25, "have": [2, 8, 14, 15, 16, 19, 22, 24, 26, 27, 28, 33, 38, 39], "head_siz": [2, 19, 27], "hello": [35, 36, 40, 43], "help": [33, 34, 39], "helper": 12, "here": [7, 31, 32, 33, 34, 39, 43], "hf": 41, "hf_token": [39, 41], "hidden_dim": [1, 2, 27], "hidden_dim_s": 2, "higher": [33, 40], "highli": 40, "hit": 1, "hold": 2, "host": [2, 8, 16, 22, 24, 29, 33, 39], "host2": 8, "hostmemoryalloc": 2, "hosts_and_port": [8, 16], "hot": [2, 7], "how": [2, 12, 27, 30, 33, 35, 36, 41], "http": [24, 35, 36, 38, 39, 40, 41], "hub": 39, "huggingfac": [27, 39, 41, 43], "huggingface_hub": 43, "hybrid": 15, "hybrid_backend": 20, "i": [1, 2, 3, 6, 7, 8, 9, 12, 14, 15, 16, 17, 18, 22, 24, 25, 26, 27, 28, 29, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43], "id": [1, 2], "idea": 25, "illeg": [7, 9, 17], "imag": 41, "image_nam": 39, "implement": [1, 2, 15, 25, 28, 39], "import": [25, 31, 32, 34, 35, 36, 40, 41, 43], "improv": 33, "includ": [2, 14, 15, 25, 26, 29, 34, 42, 43], "increas": 2, "index": [1, 2, 27, 28, 40], "indic": [1, 2, 9, 12, 27, 36], "indices_to_mask": 1, "infer": [25, 27, 40, 41, 43], "infinistoreconnector": 8, "info": 25, "inform": [2, 32, 33, 34, 41, 43], "init_lmcache_engin": [11, 12, 25], "init_logg": [0, 20], "init_max_chunk_num": 18, "initi": [12, 18, 25], "inject": [9, 17], "input": [1, 2, 6, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 25, 27], "input_group": 19, "input_token": 1, "input_tokens_list": 25, "insert": [4, 43], "insert_kei": [2, 7], "instal": [33, 35, 36, 41, 42], "instanc": [2, 25, 29, 32, 34, 36, 41, 42], "instance_id": 2, "instead": 2, "instruct": [31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 43], "int": [0, 1, 2, 4, 5, 8, 9, 10, 12, 15, 16, 17, 18, 19, 22, 24, 25, 26, 27], "int16": 19, "int32": 19, "int8": 19, "integ": [22, 24], "integr": [25, 35, 36, 42], "interact": 25, "interfac": [2, 8, 9, 16, 17, 18, 20, 40], "intern": 1, "invalid": [2, 8], "invok": 25, "io": 41, "ip": 41, "is_driver_work": 12, "is_kei": 19, "is_prefill_list": 12, "is_valid": 2, "issu": [40, 41], "issue_get": 3, "iter": [2, 15, 26, 27], "its": [8, 28], "join": [32, 34, 36], "json": [32, 34, 38, 39], "json_dict": [32, 34], "jsonl": [32, 34], "just": 40, "k": [1, 2, 19], "kei": [0, 2, 3, 4, 6, 7, 8, 9, 14, 15, 16, 17, 19, 20, 25, 26, 27], "kernel": 2, "key_bin": 19, "keys_and_chunk": [15, 26], "kivideseri": 10, "kiviseri": 10, "know": 41, "kspec": [10, 19], "ktc": [35, 36], "kv": [1, 2, 6, 7, 9, 12, 14, 15, 17, 18, 19, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34, 36, 37, 39, 40, 41, 42], "kv_blend": 31, "kv_blob": [2, 10], "kv_both": [35, 38, 39, 40], "kv_cach": [12, 25], "kv_chunk": [14, 15, 18, 26], "kv_chunk_byt": [6, 14], "kv_connector": [35, 36, 38, 39, 40], "kv_consum": 36, "kv_obj": [9, 17, 18], "kv_parallel_s": 36, "kv_produc": 36, "kv_rank": 36, "kv_role": [35, 36, 38, 39, 40], "kv_tensor": 27, "kv_tensors_mask": 27, "kv_tensors_raw": 27, "kv_transfer_config": [35, 36], "kvcach": 2, "kvlayer": 2, "kvobj": [17, 18], "kvtransferconfig": [35, 36], "kwarg": [2, 19], "l": 33, "languag": 38, "latenc": 33, "later": [25, 41], "latest": [37, 40], "launch": [1, 2, 7, 29, 32, 34, 36], "layer": [1, 19], "layer_id": 1, "layers_in_kei": 19, "ld_library_path": 40, "learn": [35, 36], "least": 38, "left": 41, "legal": [7, 9, 17], "len": [27, 32, 34, 38, 40], "length": [0, 1, 2, 5, 20, 33], "less": [35, 36], "let": [41, 42], "lib64": 40, "librari": 40, "lifecycl": 25, "like": [2, 40], "limit": [35, 36], "line": [22, 24, 32, 33, 41], "link": [39, 40, 42], "linux": 40, "list": [1, 2, 4, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 19, 22, 24, 25, 27, 32, 33, 34], "list_kei": [5, 6, 14], "llama": [33, 38, 39, 40, 43], "llm": [28, 31, 32, 34, 35, 36, 40, 42, 43], "lm": [2, 25, 32, 36], "lm_cache_blend_min_token": 22, "lm_cache_blend_recompute_ratio": 22, "lm_cache_chunk_s": [22, 24], "lm_cache_distributed_url": 24, "lm_cache_enable_blend": 22, "lm_cache_enable_p2p": 24, "lm_cache_local_devic": [22, 24], "lm_cache_lookup_url": 24, "lm_cache_max_local_cache_s": [22, 24], "lm_cache_pipelined_backend": [22, 24], "lm_cache_remote_serd": [22, 24], "lm_cache_remote_url": [22, 24], "lm_cache_save_decode_cach": [22, 24], "lm_cache_use_experiment": 24, "lm_connector": 15, "lmc_num_computed_tokens_list": 12, "lmcach": [25, 29, 31, 32, 33, 34, 35, 36, 39, 40, 41, 43], "lmcache_chunk_s": [2, 35, 36], "lmcache_config": [22, 24, 40], "lmcache_config_fil": [12, 22, 24, 29, 31, 32, 34, 38, 40], "lmcache_get_config": [11, 12], "lmcache_local_cpu": [35, 36], "lmcache_max_local_cpu_s": [35, 36], "lmcache_remote_serd": 36, "lmcache_remote_url": 36, "lmcache_retrieve_kv": [11, 12, 25], "lmcache_serv": [29, 32], "lmcache_server_process": 36, "lmcache_should_retriev": [11, 12, 25], "lmcache_should_stor": [11, 12, 25], "lmcache_store_kv": [11, 12, 25], "lmcache_use_experiment": [35, 36, 38, 39, 40], "lmcache_vllm": [22, 31, 32, 34, 39, 40, 43], "lmcacheconnector": [35, 36, 38, 39, 40], "lmcacheengin": [1, 2, 12, 25, 27], "lmcacheenginebuild": [2, 35, 36], "lmcacheengineconfig": [2, 3, 4, 7, 10, 12, 15, 19, 27], "lmcacheenginemetadata": [1, 2, 7, 10, 15, 19, 27], "lmcachemempoolmetadata": [15, 18], "lmcacheserv": 0, "lmcbackendinterfac": [15, 26], "lmchybridbackend": 15, "lmclocalbackend": 15, "lmclocaldiskbackend": 15, "lmcpipelinedremotebackend": 15, "lmcremotebackend": 15, "lmcserverconnector": [0, 8, 16], "lmsbackendinterfac": [5, 6, 14], "lmslocalbackend": [5, 6, 14], "lmslocaldiskbackend": 14, "lmsmemoryobj": [5, 6], "lmsy": [32, 40, 43], "load": [2, 7, 12, 40, 43], "load_bytes_from_disk": [2, 7], "load_disk": [2, 7], "local": [2, 14, 15, 22, 24, 29, 33, 35, 36, 39, 40, 41], "local_backend": [5, 13, 20], "local_cpu": [2, 39], "local_devic": [22, 24, 29, 31, 32, 34], "local_disk": [2, 22, 24, 29], "local_disk_backend": 2, "local_indic": 1, "local_pool": 15, "local_url": 41, "localbackendendsign": 15, "localcpubufferpool": 18, "localcpupool": 18, "localdiskbackend": [2, 7], "localgpupool": 18, "localhost": [2, 8, 16, 22, 24, 29, 32, 36, 38, 41], "localpool": 18, "locat": 1, "log": [20, 33], "logger": [0, 25], "logic": 1, "login": [41, 43], "long": [1, 35, 41], "longchat": [32, 40, 43], "longer": 39, "lookup": [2, 4, 24, 27, 38], "lookup_serv": [3, 7], "lookup_url": [2, 24], "lookupserverinterfac": [3, 4, 7], "loop": [3, 7, 8], "lower": 33, "lp": 19, "lru": [7, 9, 17], "lru_evictor": [2, 7, 15], "lruevictor": [7, 9, 17], "m": [33, 36], "machin": [39, 41], "mai": [1, 28, 33, 43], "main": [2, 28, 33], "mainli": 31, "maintain": [28, 39], "make": [25, 39], "make_key_bin": [10, 19], "make_value_bin": [10, 19], "manag": [2, 7, 27, 40], "mani": [2, 27, 42], "manner": [2, 15, 26, 36], "manual": 41, "map": 2, "mask": [1, 2, 27], "mask_to_indic": 1, "match": [1, 2, 33], "matter": 27, "max": [19, 38, 40], "max1": 19, "max_cache_s": [9, 17], "max_length": [40, 43], "max_local_cache_s": [22, 24], "max_local_cpu_s": [2, 39], "max_local_disk_s": 2, "max_model_len": [32, 34, 35, 36], "max_tensors_kei": 19, "max_tensors_valu": 19, "max_token": [31, 32, 34, 35, 36, 38, 39], "maximum": [18, 19, 22, 24], "maxtensor": 19, "mayb": 1, "me": [32, 35], "mean": [2, 27], "measur": [30, 42], "mechan": [25, 27], "mem": 18, "mem_pool": 15, "memcheck": 2, "memori": [2, 7, 10, 12, 14, 15, 18, 32, 33, 35, 36, 38, 40], "memory_alloc": [2, 3, 7, 8, 10], "memory_manag": 5, "memory_obj": [2, 7, 8, 10], "memoryallocatorinterfac": [2, 3, 7, 8, 10], "memoryformat": [2, 5], "memoryobj": [2, 3, 7, 8, 10], "memoryobjmetadata": 2, "mess": 40, "messag": [0, 39], "met": 25, "meta": [3, 8, 33, 38, 39, 40, 43], "metada": 2, "metadata": [1, 2, 6, 7, 10, 15, 18, 19, 25, 27], "method": [6, 14, 15, 26, 28], "metric": [30, 31], "might": [18, 41, 43], "min": 42, "minimum": 22, "minut": 41, "miss": 28, "mistral": [31, 32, 34, 35, 36, 39, 41, 43], "mistralai": [31, 32, 34, 35, 36, 39, 41, 43], "mixedmemoryalloc": 2, "model": [12, 25, 27, 31, 32, 34, 35, 36, 38, 39, 40, 41], "model_card": 43, "model_config": [12, 25], "model_execut": [12, 25], "model_input": [12, 25], "model_lay": [11, 12], "model_nam": [0, 10, 12, 19, 20, 32, 34, 41], "model_runn": 25, "modelconfig": [12, 25], "modelinputforgpuwithsamplingmetadata": [12, 25], "modelinputsubset": [11, 12], "modelrunn": 25, "modifi": [1, 25], "modul": [13, 20, 25, 32], "modulefind": 25, "monitor": 33, "more": [2, 28, 31, 33, 35, 36, 37, 41, 43], "movement": 18, "mpool_metadata": 15, "multi": [34, 42], "multipl": [1, 2, 15, 26, 29, 32, 41], "multiprocess": [31, 36], "must": 1, "my": [35, 40, 43], "n": [3, 16, 32, 33, 34, 40], "naiv": [2, 36], "naivedeseri": 10, "naivedistributedserv": 3, "naiveseri": 10, "name": [0, 2, 8, 9, 12, 16, 17, 22, 24, 35, 38, 39, 40, 43], "nccl": 40, "nchannel": [10, 19], "ndim": 1, "necessari": [6, 12, 14, 15, 25, 26, 40], "necessarili": 42, "need": [2, 24, 25, 31, 32, 33, 34, 35, 36], "nest": [2, 14, 15, 27], "network": [28, 39], "network_url": 41, "network_work": 15, "never": 2, "new": [1, 2, 9, 17, 25, 28, 40, 41], "new_request": 1, "newer": 24, "newli": 31, "nfirst": [32, 34], "nightli": 40, "nlayer": [10, 19], "nn": [12, 25], "node": 36, "non": [3, 7, 12, 25, 27], "none": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 25, 26, 27, 32, 34], "note": [1, 2, 35, 36, 38, 40, 41], "noth": 1, "now": [2, 3, 7, 31, 32, 34, 35, 40, 41, 43], "nsecond": [32, 34], "ntoken": [10, 19], "num_block": 2, "num_computed_tokens_list": [12, 25], "num_head": [2, 19, 27], "num_kv_head": 27, "num_lay": [2, 27], "num_skip_chunk": 27, "num_skip_prefix_chunk": 27, "num_token": [1, 2, 27], "number": [1, 2, 15, 18, 19, 22, 26, 27, 32], "nvcc": 40, "nvidia": [39, 41], "o": [32, 33, 34, 35, 36, 40], "obj": [7, 16], "object": [1, 2, 6, 7, 8, 10, 16, 32, 34], "occur": 25, "offer": 39, "offici": 39, "offlin": [32, 40, 43], "offline_infer": [29, 32, 34], "offline_inference_output": [32, 34], "offline_precomput": 31, "offlinekvprecomput": 31, "offload": [37, 42], "often": 43, "onc": [29, 33, 41, 42], "one": [8, 16, 32, 41], "ones": 24, "ongo": 7, "onli": [2, 8, 16, 18, 25, 27, 42, 43], "onlin": 40, "open": [31, 32, 34, 41], "openai": [39, 40, 41], "oper": [14, 15, 25, 26, 27], "optim": 43, "option": [1, 2, 7, 8, 12, 16, 22, 24, 25, 29], "ordereddict": [7, 9, 17], "origin": [1, 12, 19], "original_posit": 1, "other": [27, 29, 32, 33, 34, 41, 43], "otherwis": [2, 8, 12, 14, 15, 16, 25, 27], "our": 33, "out": 37, "output": [1, 6, 14, 15, 19, 31, 32, 33, 34, 35, 36], "output_buff": 19, "output_fil": [32, 34], "output_file_nam": [32, 34], "output_length": 19, "over": 28, "overlap": [2, 24], "overrid": [6, 14, 15, 26], "overview": 42, "overwrit": 2, "own": 33, "p": 38, "p2p": [37, 42], "packag": [2, 11, 13, 15, 25, 40], "packlength": [0, 20], "page": [2, 12], "pair": [8, 16], "paper": 28, "parallel": [12, 25], "parallel_config": [12, 25], "parallelconfig": [12, 25], "param": [1, 2, 19, 32, 34], "paramet": [1, 2, 6, 7, 12, 14, 15, 19, 22, 24, 26, 27], "pardir": [32, 34], "pars": 8, "parse_remote_url": 8, "parsedremoteurl": 8, "part": 8, "partial": [25, 27], "pass": [1, 2, 22, 24, 32, 34], "path": [0, 7, 14, 15, 19, 20, 29, 32, 34, 40], "pattern": 33, "pdf": 33, "peak": 41, "peer": [3, 24], "per": [33, 35, 36], "perf_count": [32, 34], "perform": [3, 4, 18, 25, 28, 30], "phy_siz": 2, "physic": 2, "pin": 2, "pinmemoryalloc": 2, "pip": [35, 36, 41, 42], "pipelin": [15, 22, 24, 29, 32], "pipelined_backend": [22, 24, 29, 32], "pleas": [24, 29, 33, 34, 39, 40, 41, 43], "plot": 33, "point": 25, "pointer": 18, "pool": [15, 18], "popen": 36, "port": [8, 16, 22, 24, 29, 32, 36, 38, 40], "port2": 8, "portion": 27, "posit": 1, "positional_encod": 1, "possibl": [22, 24], "post": [38, 39], "post2": 40, "potenti": 41, "pre": [2, 31, 40], "preciou": 42, "precompute_kv": 31, "prefetch": [2, 7], "prefetch_callback": [2, 7], "prefil": [11, 12, 25, 28, 35, 37, 39, 42], "prefill_don": 36, "prefill_process": 36, "prefix": [1, 2, 14, 15, 26, 27, 35, 41, 42], "prefix_hash": 27, "prepare_environ": 33, "prerequisit": 37, "prevent": 41, "primari": 25, "print": [31, 32, 34, 35, 36], "prior": 33, "proce": 25, "process": [2, 25, 28, 33, 36], "process_result": 33, "process_token": 2, "produc": 2, "product": 18, "profil": 25, "program": 25, "project": 28, "prompt": [1, 25, 28, 32, 34, 36, 38, 43], "properti": 2, "protocol": 20, "provid": [2, 33], "proxi": 25, "proxymodul": 25, "pull": 38, "purpos": 2, "put": [2, 5, 6, 7, 8, 9, 12, 14, 15, 26], "put_block": 15, "put_nonblock": 15, "put_work": 15, "putstatu": [7, 9, 17], "py": [25, 29, 31, 32, 33, 34, 35, 36], "python": [29, 31, 32, 33, 35, 36, 39, 40, 41, 43], "python3": [33, 34], "pytorch": 19, "q": 1, "qa": [19, 42], "qkv": 1, "qualnam": [2, 9, 12, 16, 17], "quant": 19, "quantiz": 19, "quantizationspec": [10, 19], "queri": [1, 6, 14, 15, 26, 31, 41], "query_start_loc": 1, "question": 31, "quick": [32, 42], "qwen": 43, "r": [31, 32, 34, 35, 36], "radix": 2, "radixtokendatabas": 2, "rag": 42, "rais": [2, 8], "rang": [2, 7], "ratio": 22, "raw": [2, 36], "raw_byt": 2, "raw_data": 2, "read": [15, 31, 32, 34], "reader": 3, "real": [2, 31], "rebuild": [12, 25], "rebuilt": 12, "receiv": 28, "receive_al": [8, 16], "receive_all_cli": 3, "receive_all_serv": 3, "recenc": 17, "recombine_byt": 19, "recommend": [28, 40], "recomput": 22, "recompute_ratio": 1, "reconstruct": 25, "redi": [8, 16, 22, 24, 29, 38], "redis_connector": 15, "redis_service_nam": [8, 16], "redis_timeout": [8, 16], "redisconnector": [8, 16], "redislookupserv": 4, "redissentinelconnector": [8, 16], "reduc": [35, 36, 42], "reduct": [28, 42], "redund": 27, "ref": [2, 8], "ref_count": 2, "ref_count_down": 2, "ref_count_up": 2, "refer": [24, 28, 33, 40, 41, 43], "reflect": [12, 25], "relat": [35, 36], "releas": 24, "reli": 2, "rememb": 29, "remot": [8, 15, 16, 22, 24, 29, 36], "remote_backend": 20, "remote_serd": [2, 22, 24, 29, 32], "remote_url": [2, 8, 16, 22, 24, 29, 32], "remotebackendendsign": 15, "remotebytesconnector": 16, "remoteconnector": [8, 16], "remoteconnectordebugwrapp": 16, "remotetensorconnector": 16, "remov": [2, 4, 5, 6, 7, 14, 15], "replac": 41, "repositori": [25, 28, 33, 40], "req": 12, "request": [1, 2, 7, 12, 25, 28, 32, 33, 34, 35, 38], "requestoutput": [32, 34], "requir": [8, 12, 16, 28, 43], "resid": 2, "resourc": 2, "respons": [7, 25], "rest": 27, "result": [1, 33], "ret_mask": 27, "retriev": [2, 6, 12, 14, 15, 20, 22, 24, 25, 26, 27, 28, 29, 32, 38], "retrieve_statu": 12, "retrieved_k": 1, "retrieved_v": 1, "retrievestatu": [11, 12], "return": [1, 2, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 25, 26, 27, 32, 34, 36], "return_tupl": 27, "reus": [33, 41, 42], "reusabl": [29, 42], "reverse_positional_encod": 1, "right": 41, "roi": 1, "role": [32, 34, 39], "root": 39, "root_directori": 33, "round": 42, "run": [22, 24, 25, 30, 31, 32, 34, 35, 36, 38, 40, 43], "run_decod": 36, "run_lmcache_serv": 36, "run_prefil": 36, "runtim": [39, 41], "safe": 16, "safe_serd": 15, "safedeseri": 19, "safeseri": 19, "safetensor": [22, 24, 28, 29], "same": [1, 2, 7, 19, 24, 27, 33, 40, 41], "sampl": [25, 32, 34], "sampling_param": [32, 34, 35, 36], "sampling_params_gener": 31, "samplingparam": [31, 32, 34, 35, 36], "sata3": 41, "save": [19, 22, 24, 30, 31, 32, 33, 35, 36, 39, 41, 42], "save_decod": 34, "save_decode_cach": [2, 22, 24, 34], "save_disk": 15, "save_pretrain": 41, "score": 34, "script": [25, 33, 35, 36, 40, 41, 43], "seamless": 25, "seamlessli": 25, "search": [2, 7], "search_rang": [2, 7], "second": [2, 8, 16, 31, 32, 33, 34, 35, 41], "second_output": [32, 34], "second_prompt": 35, "section": [39, 40], "see": [2, 40, 41], "segmengt": 1, "segment": 39, "select": [1, 30, 42], "self": [19, 25, 27], "send": [8, 16, 25, 38], "send_al": 16, "sent": [1, 6], "sentencepiec": 41, "sentinel": [8, 16, 22, 24], "separ": [8, 16, 40], "seq_len": [2, 27], "sequenc": [1, 2, 27], "serd": [15, 22, 24], "serde_typ": 10, "seri": 33, "serial": [0, 10, 19, 20, 28, 29, 36], "serializerdebugwrapp": 19, "serv": [2, 22, 24, 25, 32, 38, 39, 40, 41, 42], "server": [0, 3, 4, 8, 15, 16, 20, 24, 28, 29, 32, 36, 38, 40, 42], "server_fail": [0, 20], "server_proc": 36, "server_storage_backend": 13, "server_success": [0, 20], "servermetamessag": [0, 3, 8, 20], "servic": [8, 16, 41], "set": [2, 8, 12, 15, 16, 22, 24, 25, 29, 35, 36, 43], "set_positional_encod": 1, "set_reverse_positional_encod": 1, "set_start_method": 31, "setup": [33, 39], "sh": [22, 24, 33, 39, 41], "sha256": 27, "shape": [0, 1, 2, 5, 7, 19, 20, 27], "share": [24, 28, 32, 35, 37, 41, 42], "shared_prompt": 35, "short": 1, "should": [1, 2, 3, 6, 7, 8, 12, 14, 15, 16, 19, 22, 24, 25, 26, 27, 33, 34, 38], "shouldn": 2, "show": [33, 41], "shown": [29, 33, 41], "shut": [25, 41], "signific": [28, 38], "similar": [25, 29], "simpli": 40, "singl": [1, 15, 19, 27, 32, 41], "size": [0, 1, 2, 5, 7, 17, 18, 20, 22, 24, 27, 28], "skip": [12, 27], "skip_exist": 27, "sleep": [31, 35, 36], "slot": 2, "slot_map": 2, "slot_mapping_flat": [12, 25], "slow": 29, "snapshot": 33, "so": [25, 41, 43], "socket": 3, "some": [1, 2, 6, 28, 32, 33, 34, 38], "soon": 40, "sourc": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 26, 27, 41], "spawn": 31, "special": [1, 2], "specif": [2, 27, 33], "specifi": [2, 7, 8, 16, 29], "speed": 41, "speedup": 42, "split": [1, 28], "spt": 1, "sptblendretriev": 1, "sptblendretrievertask": 1, "ssd": 41, "stage": 25, "standard": 41, "star": 42, "start": [1, 2, 3, 8, 9, 12, 16, 17, 19, 25, 29, 32, 36, 38, 39, 40, 41], "start_idx": 27, "start_indic": 19, "start_lay": [11, 12, 19], "start_pos_list": [12, 25], "start_ui": 41, "state": 25, "static": [0, 2, 10, 19, 40], "statu": 33, "stderr": 33, "step": [25, 37], "storag": [0, 2, 7, 9, 17, 20, 22, 24, 29, 33, 42], "storage_backend": [2, 5, 20, 26], "storage_manag": [2, 3], "storagebackend": 2, "storagebackendinterfac": [2, 7], "storagemanag": [2, 3, 7], "store": [2, 6, 7, 12, 14, 15, 18, 25, 26, 27, 28, 29, 42], "store_statu": 12, "storestatu": [11, 12], "stori": 35, "str": [0, 1, 2, 4, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 19, 22, 24, 26, 27, 36], "stream": [19, 25], "streamlit": 41, "string": [8, 16], "structur": 33, "sub": 2, "submit_prefetch_task": [2, 7], "submit_put_task": [2, 7], "submodul": [11, 13, 20], "subpackag": 20, "subprocess": 36, "subset": [2, 7], "succ": 2, "sudo": 41, "suffix": 27, "suffix_prefil": [11, 12], "suit": 33, "summar": 25, "support": [2, 24, 27, 29, 32, 33, 35, 36, 42], "sure": 39, "sweep": 15, "synchron": 28, "sys_prompt": 31, "system": 39, "t": [2, 19, 25], "t1": [32, 34], "t2": [32, 34], "t3": [32, 34], "t4": [32, 34], "tabl": 2, "tag": 39, "tail": 33, "take": [1, 2, 41], "taken": 27, "talk": 31, "target": [27, 36], "target_buff": 19, "target_dim": 1, "task": [1, 7, 25], "tell": 35, "temperatur": [31, 32, 34, 35, 36], "tensor": [1, 2, 10, 12, 14, 15, 16, 17, 18, 19, 25, 26, 27, 28, 36], "tensor_parallel_s": 31, "tensormemoryalloc": 2, "tensormemoryobj": 2, "term": 43, "termin": [36, 41], "test": [18, 30], "test_lmcache_local_cpu": 33, "text": [1, 29, 31, 32, 34, 35, 36, 42], "than": 41, "thei": [31, 41], "them": [2, 19, 28], "therefor": 1, "thi": [1, 2, 3, 6, 12, 14, 15, 18, 22, 24, 25, 26, 29, 31, 33, 34, 35, 36, 38, 39, 40, 41, 43], "thing": [6, 14, 15, 26], "third": 2, "though": 28, "thread": 16, "thread_saf": [0, 20], "three": [2, 28], "through": 15, "throughout": 25, "throughput": 33, "thu": 42, "thudm": 43, "time": [25, 31, 32, 33, 34, 35, 36, 42], "time_taken": [32, 34], "timeout": [8, 16, 36], "tmp": 33, "to_byt": 19, "to_gpu": 2, "to_original_config": 2, "to_str": [0, 20], "token": [1, 2, 6, 14, 15, 19, 22, 25, 26, 27, 28, 31, 32, 33, 34, 35, 36, 41, 42, 43], "token_chunk": 27, "token_dim": [1, 2], "token_seg": 1, "tokendatabas": 2, "top": 43, "top_p": [31, 32, 34, 35, 36], "torch": [0, 1, 2, 5, 12, 18, 19, 22, 24, 25, 28, 29, 31, 40], "torch_quant": 19, "torch_quant_vector": 19, "torch_serd": 15, "torchdeseri": 19, "torchseri": 19, "total": 19, "tp": 33, "transfer": [36, 38, 39, 40], "transform": [32, 34, 41], "transmiss": 28, "transmit": 28, "tree": [2, 39], "tri": 40, "trigger": 41, "true": [2, 7, 8, 14, 15, 16, 24, 26, 27, 29, 31, 34, 35, 36, 38, 39, 40], "ttft": [31, 33, 42], "tupl": [1, 2, 4, 8, 9, 10, 12, 14, 15, 16, 17, 19, 26, 27], "turn": 34, "two": [22, 24, 25, 27, 32, 35, 38, 41], "txt": [31, 32, 34], "type": [1, 2, 9, 10, 12, 16, 17, 19, 33, 38, 39, 41], "typic": 41, "uint8": 19, "undefin": [1, 2], "underli": 2, "unit": 18, "until": [2, 15], "unus": 41, "up": [15, 25, 35, 36, 40, 43], "updat": [1, 7, 9, 15, 17], "update_on_get": 17, "update_on_hit": [7, 9], "update_on_put": [7, 9, 17], "upon": 25, "uppercas": 2, "url": [8, 16, 22, 24, 36, 40, 41], "us": [1, 2, 7, 8, 9, 15, 16, 17, 18, 21, 23, 25, 27, 28, 29, 31, 32, 33, 35, 36, 37, 38, 39, 40, 41, 42, 43], "usabl": 27, "usag": [29, 30, 33, 35, 36, 42], "use_experiment": 24, "use_gpu": 2, "user": [25, 31, 32, 34, 39], "user_input": [32, 34], "user_inputs_batch": [32, 34], "user_inputs_of_batch": [32, 34], "user_prompt": 31, "usr": [39, 40], "util": [11, 20, 32, 35, 36, 38, 40], "v": [1, 2, 19, 39], "v0": [24, 31, 32, 34, 35, 36, 37, 39, 41, 42, 43], "v1": [35, 36, 38, 39, 42, 43], "vaild_mask": 1, "valid": [1, 2], "valid_mask": 1, "valu": [1, 2, 9, 12, 15, 16, 17, 19, 22, 24, 25, 35, 36], "value_bin": 19, "valueerror": [2, 8], "variabl": [1, 2, 8, 12, 16, 21, 23, 35, 36], "varieti": 43, "ve": 32, "venv": 40, "veri": 35, "verifi": 39, "via": [2, 27, 40, 43], "view": [18, 41], "virtual": 40, "visit": 39, "vllm": [1, 11, 24, 25, 27, 28, 29, 31, 32, 33, 34, 35, 36, 38, 39, 40, 42, 43], "vllm_adapt": [11, 25], "vllm_inject": 25, "vllmnestedtuplegpuconnector": 2, "vllmpagedmemgpuconnector": 2, "vllmpagedmemgpuconnectorv2": 2, "vspec": [10, 19], "w": [32, 34], "wai": [2, 22, 24, 25, 32], "wait": [27, 36], "want": 39, "warm": 41, "watch": 42, "we": [2, 12, 25, 28, 33, 36, 40], "webui": 41, "weight": 41, "well": 42, "what": [31, 34], "wheel": 40, "when": [1, 2, 9, 17, 25, 28, 29, 40], "whenev": 28, "where": [1, 2], "whether": [1, 7, 9, 12, 14, 15, 22, 24, 25, 26, 27, 29, 32, 34], "which": [1, 2, 25, 27, 33, 41], "while": [25, 27, 40], "who": 39, "whole": 2, "within": [28, 35, 36], "without": 36, "word": [34, 41], "worker": [12, 25], "worker_id": [0, 20], "world_siz": [0, 20], "wrap": [2, 22, 24], "wrapper": [25, 28], "write": [15, 19, 32, 33, 34, 39, 41], "writer": 3, "x": [1, 22, 24, 38, 39], "xq": 19, "y": [1, 40], "yaml": [2, 21, 23, 29, 31, 32, 34, 38, 40], "yet": [24, 25, 40], "you": [22, 24, 29, 31, 32, 33, 34, 35, 36, 39, 40, 43], "your": [32, 33, 34, 35, 36, 38, 39, 40, 41, 43], "your_huggingface_token": 39, "yourself": 41, "z": 1, "zip": 27}, "titles": ["LMCache Modules", "LMCache Blend", "LMCache Experimental", "lmcache.experimental.distributed_server package", "lmcache.experimental.lookup_server package", "lmcache.experimental.server package", "lmcache.experimental.server.storage_backend package", "lmcache.experimental.storage_backend package", "lmcache.experimental.storage_backend.connector package", "lmcache.experimental.storage_backend.evictor package", "lmcache.experimental.storage_backend.naive_serde package", "LMCache Integration", "lmcache.integration.vllm package", "LMCache Server", "lmcache.server.server_storage_backend package", "LMCache Storage Backend", "lmcache.storage_backend.connector package", "lmcache.storage_backend.evictor package", "lmcache.storage_backend.mem_pool package", "lmcache.storage_backend.serde package", "lmcache", "LMCache v0", "Configuring LMCache v0", "LMCache v1", "Configuring LMCache v1", "LLM Engine", "LMCache Backend", "LMCache Engine", "LMCache Overview", "Selecting a backend", "LMCache v0", "KV blending", "Usage", "End-to-end measurements", "Saving the decode cache", "CPU Offloading", "Disaggregated prefill", "LMCache v1", "P2P KV Cache Sharing", "Docker Installation", "Pip Installation", "3 Min Quick Example: Docker + Speedup with vLLM", "Welcome to LMCache!", "Supported Models"], "titleterms": {"": 42, "3": 41, "abstract_backend": [6, 7, 14, 15], "abstract_serv": [3, 4], "advanc": 42, "backend": [15, 26, 29], "base_connector": [8, 16], "base_evictor": [9, 17], "base_pool": 18, "blend": [1, 31], "build": 39, "cach": [34, 38], "cache_engin": 2, "cachegen_bas": [10, 19], "cachegen_decod": [10, 19], "cachegen_encod": [10, 19], "clean": 41, "compat": 40, "config": 2, "configur": [21, 22, 23, 24, 42], "connector": [8, 16], "contain": 39, "content": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 17, 18], "cpu": 35, "decod": 34, "demo": 41, "detail": 42, "develop": 42, "disaggreg": 36, "distributed_serv": 3, "do": 41, "docker": [39, 41], "document": 42, "end": 33, "engin": [25, 27], "environ": [22, 24], "evictor": [9, 17], "exampl": [30, 37, 41, 42], "executor": 1, "experiment": [2, 3, 4, 5, 6, 7, 8, 9, 10], "fast_serd": 19, "file": [22, 24], "from": [39, 40], "further": 33, "get": 42, "gpu_connector": 2, "happen": 41, "how": [31, 32, 34], "hybrid_backend": 15, "imag": 39, "infinistore_connector": 8, "instal": [39, 40], "instanc": 28, "integr": [11, 12], "inter": 28, "interfac": 1, "introduct": 41, "kivi_serd": 10, "kv": [31, 38], "level": 28, "llm": 25, "lm_connector": [8, 16], "lmcach": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 30, 37, 42], "local_backend": [6, 14, 15], "local_disk_backend": 7, "local_pool": 18, "log": 0, "lookup_serv": 4, "lru_evictor": [9, 17], "matrix": 40, "measur": 33, "mem_pool": 18, "memory_manag": 2, "metric": 33, "min": 41, "model": [42, 43], "modul": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19], "naive_serd": 10, "naive_serv": 3, "need": 41, "next": 42, "offload": 35, "overview": 28, "p2p": 38, "packag": [3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], "perform": [33, 41], "pip": 40, "prefil": 36, "prerequisit": [38, 41], "protocol": 0, "pull": 39, "quick": 41, "quickstart": 40, "redis_connector": [8, 16], "redis_serv": 4, "releas": 40, "remote_backend": 15, "requir": 40, "retriev": 1, "run": [33, 39, 41], "safe_serd": 19, "save": 34, "select": 29, "serd": [10, 19], "server": [5, 6, 13, 14], "server_storage_backend": 14, "share": 38, "sourc": [39, 40], "speedup": 41, "start": 42, "step": [38, 41], "storag": 15, "storage_backend": [6, 7, 8, 9, 10, 15, 16, 17, 18, 19], "storage_manag": 7, "submodul": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19], "subpackag": [0, 2, 5, 7, 11, 13, 15], "support": 43, "test": [33, 39], "token_databas": 2, "torch_serd": 19, "up": 41, "us": [22, 24], "usag": 32, "util": [0, 5, 12], "v0": [21, 22, 30, 40], "v1": [23, 24, 37, 40], "variabl": [22, 24], "version": 40, "vllm": [12, 41], "vllm_adapt": 12, "welcom": 42, "what": [41, 42], "when": 41, "yaml": [22, 24], "you": 41}})